<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STIR: stir::PoissonLogLikelihoodWithLinearModelForMean&lt; TargetT &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STIR
   &#160;<span id="projectnumber">4.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacestir.html">stir</a></li><li class="navelem"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">PoissonLogLikelihoodWithLinearModelForMean</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">stir::PoissonLogLikelihoodWithLinearModelForMean&lt; TargetT &gt; Class Template Reference<span class="mlabels"><span class="mlabel">abstract</span></span><div class="ingroups"><a class="el" href="group__STIR.html">STIR</a> &raquo; <a class="el" href="group__STIR__library.html">STIR library</a> &raquo; <a class="el" href="group__recon__buildblock.html">Reconstruction building blocks</a> &raquo; <a class="el" href="group__GeneralisedObjectiveFunction.html">Objective functions for iterative estimation of variables</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>a base class for LogLikelihood of independent Poisson variables where the mean values are linear combinations of the parameters.  
 <a href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="PoissonLogLikelihoodWithLinearModelForMean_8h_source.html">stir/recon_buildblock/PoissonLogLikelihoodWithLinearModelForMean.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for stir::PoissonLogLikelihoodWithLinearModelForMean&lt; TargetT &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean__inherit__graph.png" border="0" usemap="#stir_1_1PoissonLogLikelihoodWithLinearModelForMean_3_01TargetT_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="stir_1_1PoissonLogLikelihoodWithLinearModelForMean_3_01TargetT_01_4_inherit__map" id="stir_1_1PoissonLogLikelihoodWithLinearModelForMean_3_01TargetT_01_4_inherit__map">
<area shape="rect" id="node6" href="classstir_1_1RegisteredParsingObject.html" title="RegisteredParsingObject\l\&lt; PoissonLogLikelihoodWithLinear\lKineticModelAndDynamicProjectionData\l\&lt; TargetT \&gt;, GeneralisedObjectiveFunction\l\&lt; TargetT \&gt;, PoissonLogLikelihoodWithLinearModelFor\lMean\&lt; TargetT \&gt; \&gt;" alt="" coords="1433,5,1811,105"/>
<area shape="rect" id="node8" href="classstir_1_1RegisteredParsingObject.html" title="RegisteredParsingObject\l\&lt; PoissonLogLikelihoodWithLinear\lModelForMeanAndDynamicProjData\l\&lt; TargetT \&gt;, GeneralisedObjectiveFunction\l\&lt; TargetT \&gt;, PoissonLogLikelihoodWithLinearModel\lForMean\&lt; TargetT \&gt; \&gt;" alt="" coords="1443,129,1801,229"/>
<area shape="rect" id="node10" href="classstir_1_1RegisteredParsingObject.html" title="RegisteredParsingObject\l\&lt; PoissonLogLikelihoodWithLinear\lModelForMeanAndGatedProjDataWithMotion\l\&lt; TargetT \&gt;, GeneralisedObjectiveFunction\l\&lt; TargetT \&gt;, PoissonLogLikelihoodWithLinearModelFor\lMean\&lt; TargetT \&gt; \&gt;" alt="" coords="1835,440,2212,540"/>
<area shape="rect" id="node12" href="classstir_1_1RegisteredParsingObject.html" title="RegisteredParsingObject\l\&lt; PoissonLogLikelihoodWithLinear\lModelForMeanAndProjData\&lt; TargetT\l \&gt;, GeneralisedObjectiveFunction\l\&lt; TargetT \&gt;, PoissonLogLikelihoodWithLinear\lModelForMean\&lt; TargetT \&gt; \&gt;" alt="" coords="1463,364,1781,464"/>
<area shape="rect" id="node14" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeData.html" title="An objective function class appropriate for PET list mode data. " alt="" coords="1487,539,1757,595"/>
<area shape="rect" id="node17" href="classstir_1_1SumOfGeneralisedObjectiveFunctions.html" title="SumOfGeneralisedObjective\lFunctions\&lt; PoissonLogLikelihood\lWithLinearModelForMeanAndProjData\l\&lt; TargetT \&gt;, TargetT, PoissonLogLikelihood\lWithLinearModelForMean\&lt; TargetT \&gt; \&gt;" alt="" coords="1470,254,1774,339"/>
<area shape="rect" id="node2" href="classstir_1_1GeneralisedObjectiveFunction.html" title="A base class for &#39;generalised&#39; objective functions, i.e. objective functions for which at least a &#39;gr..." alt="" coords="953,356,1144,397"/>
<area shape="rect" id="node3" href="classstir_1_1RegisteredObject.html" title="stir::RegisteredObject\l\&lt; GeneralisedObjectiveFunction\l\&lt; TargetT \&gt; \&gt;" alt="" coords="673,349,904,405"/>
<area shape="rect" id="node4" href="classstir_1_1RegisteredObjectBase.html" title="Base class for all classes that can parse .par files (and more?)The only reason that this class exist..." alt="" coords="5,366,200,393"/>
<area shape="rect" id="node5" href="classstir_1_1RegisteredObject.html" title="Helper class to provide registry mechanisms to a Base classSuppose you have a hierarchy of classes wi..." alt="" coords="249,388,412,429"/>
<area shape="rect" id="node7" href="classstir_1_1PoissonLogLikelihoodWithLinearKineticModelAndDynamicProjectionData.html" title="a base class for LogLikelihood of independent Poisson variables where the mean values are linear comb..." alt="" coords="2395,27,2653,83"/>
<area shape="rect" id="node9" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndDynamicProjData.html" title="a base class for LogLikelihood of independent Poisson variables where the mean values are linear comb..." alt="" coords="2389,151,2659,207"/>
<area shape="rect" id="node11" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion.html" title="a base class for LogLikelihood of independent Poisson variables where the mean values are linear comb..." alt="" coords="2871,397,3121,453"/>
<area shape="rect" id="node13" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndProjData.html" title="An objective function class appropriate for PET emission data. " alt="" coords="2391,386,2657,442"/>
<area shape="rect" id="node15" href="classstir_1_1RegisteredParsingObject.html" title="RegisteredParsingObject\l\&lt; PoissonLogLikelihoodWithLinear\lModelForMeanAndListModeDataWithProjMatrix\lByBin\&lt; TargetT \&gt;, GeneralisedObjectiveFunction\l\&lt; TargetT \&gt;, PoissonLogLikelihoodWithLinearModelForMean\lAndListModeData\&lt; TargetT \&gt; \&gt;" alt="" coords="2318,517,2730,617"/>
<area shape="rect" id="node16" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeDataWithProjMatrixByBin.html" title="Class for PET list mode data from static images for a scanner with discrete detectors. " alt="" coords="2861,539,3131,595"/>
<area shape="rect" id="node18" href="classstir_1_1RegisteredParsingObject.html" title="stir::RegisteredParsingObject\l\&lt; PoissonLogLikelihoodWithLinear\lModelForMeanAndGatedProjDataWithMotion\l\&lt; TargetT \&gt;, GeneralisedObjectiveFunction\l\&lt; TargetT \&gt;, SumOfGeneralisedObjectiveFunctions\l\&lt; PoissonLogLikelihoodWithLinearModelForMeanAndProjData\l\&lt; TargetT \&gt;, TargetT, PoissonLogLikelihoodWithLinearModelForMean\&lt; TargetT \&gt; \&gt; \&gt;" alt="" coords="2236,245,2812,359"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a351a7cf4f32a62dc9c1bbdd5d5e0aee7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a351a7cf4f32a62dc9c1bbdd5d5e0aee7">compute_sub_gradient_without_penalty</a> (TargetT &amp;gradient, const TargetT &amp;current_estimate, const int subset_num)</td></tr>
<tr class="memdesc:a351a7cf4f32a62dc9c1bbdd5d5e0aee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation in terms of <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a1be81e2443e163294c4ec6cb722160aa" title="This should compute the gradient of the (unregularised) objective function plus the (sub)sensitivity...">compute_sub_gradient_without_penalty_plus_sensitivity()</a>  <a href="#a351a7cf4f32a62dc9c1bbdd5d5e0aee7">More...</a><br /></td></tr>
<tr class="separator:a351a7cf4f32a62dc9c1bbdd5d5e0aee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be81e2443e163294c4ec6cb722160aa"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a1be81e2443e163294c4ec6cb722160aa">compute_sub_gradient_without_penalty_plus_sensitivity</a> (TargetT &amp;gradient, const TargetT &amp;current_estimate, const int subset_num)=0</td></tr>
<tr class="memdesc:a1be81e2443e163294c4ec6cb722160aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This should compute the gradient of the (unregularised) objective function plus the (sub)sensitivity.  <a href="#a1be81e2443e163294c4ec6cb722160aa">More...</a><br /></td></tr>
<tr class="separator:a1be81e2443e163294c4ec6cb722160aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fe82f5f8802ddbede7798fef74d56ab"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classstir_1_1Succeeded.html">Succeeded</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a3fe82f5f8802ddbede7798fef74d56ab">set_up</a> (shared_ptr&lt; TargetT &gt; const &amp;target_sptr)</td></tr>
<tr class="memdesc:a3fe82f5f8802ddbede7798fef74d56ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">set-up sensitivity etc if possible  <a href="#a3fe82f5f8802ddbede7798fef74d56ab">More...</a><br /></td></tr>
<tr class="separator:a3fe82f5f8802ddbede7798fef74d56ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3af6c10b3de9b0410538a7e7e897f1aa"><td class="memItemLeft" align="right" valign="top"><a id="a3af6c10b3de9b0410538a7e7e897f1aa"></a>
const TargetT &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a3af6c10b3de9b0410538a7e7e897f1aa">get_sensitivity</a> () const</td></tr>
<tr class="memdesc:a3af6c10b3de9b0410538a7e7e897f1aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a const reference to the total sensitivity. <br /></td></tr>
<tr class="separator:a3af6c10b3de9b0410538a7e7e897f1aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4d5f2a5a73b7dac0c228d3ae3f68ce8"><td class="memItemLeft" align="right" valign="top"><a id="ac4d5f2a5a73b7dac0c228d3ae3f68ce8"></a>
const TargetT &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#ac4d5f2a5a73b7dac0c228d3ae3f68ce8">get_subset_sensitivity</a> (const int subset_num) const</td></tr>
<tr class="memdesc:ac4d5f2a5a73b7dac0c228d3ae3f68ce8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a const reference to the sensitivity for a subset. <br /></td></tr>
<tr class="separator:ac4d5f2a5a73b7dac0c228d3ae3f68ce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb55b3cf0e61134eaf21f44c7420c98"><td class="memItemLeft" align="right" valign="top"><a id="a5fb55b3cf0e61134eaf21f44c7420c98"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a5fb55b3cf0e61134eaf21f44c7420c98">add_subset_sensitivity</a> (TargetT &amp;sensitivity, const int subset_num) const =0</td></tr>
<tr class="memdesc:a5fb55b3cf0e61134eaf21f44c7420c98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add subset sensitivity to existing data. <br /></td></tr>
<tr class="separator:a5fb55b3cf0e61134eaf21f44c7420c98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62f270d7bd5b0ef331c702ed5e6815c7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a62f270d7bd5b0ef331c702ed5e6815c7">get_use_subset_sensitivities</a> () const</td></tr>
<tr class="memdesc:a62f270d7bd5b0ef331c702ed5e6815c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">find out if subset_sensitivities are used  <a href="#a62f270d7bd5b0ef331c702ed5e6815c7">More...</a><br /></td></tr>
<tr class="separator:a62f270d7bd5b0ef331c702ed5e6815c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0516641eac4e7348810c2694b63dad63"><td class="memItemLeft" align="right" valign="top"><a id="a0516641eac4e7348810c2694b63dad63"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a0516641eac4e7348810c2694b63dad63">get_recompute_sensitivity</a> () const</td></tr>
<tr class="memdesc:a0516641eac4e7348810c2694b63dad63"><td class="mdescLeft">&#160;</td><td class="mdescRight">find current value of recompute_sensitivity <br /></td></tr>
<tr class="separator:a0516641eac4e7348810c2694b63dad63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6d2e9bacac2ec151ef48552ab8cfe95"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#ad6d2e9bacac2ec151ef48552ab8cfe95">get_sensitivity_filename</a> () const</td></tr>
<tr class="memdesc:ad6d2e9bacac2ec151ef48552ab8cfe95"><td class="mdescLeft">&#160;</td><td class="mdescRight">get filename to read (or write) the total sensitivity  <a href="#ad6d2e9bacac2ec151ef48552ab8cfe95">More...</a><br /></td></tr>
<tr class="separator:ad6d2e9bacac2ec151ef48552ab8cfe95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a785b137dfe9c515f485ba847273cb183"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a785b137dfe9c515f485ba847273cb183">get_subsensitivity_filenames</a> () const</td></tr>
<tr class="memdesc:a785b137dfe9c515f485ba847273cb183"><td class="mdescLeft">&#160;</td><td class="mdescRight">get filename pattern to read (or write) the subset sensitivities  <a href="#a785b137dfe9c515f485ba847273cb183">More...</a><br /></td></tr>
<tr class="separator:a785b137dfe9c515f485ba847273cb183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e1af7b4bedf6fc9114a8bb54db1c56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a59e1af7b4bedf6fc9114a8bb54db1c56">fill_nonidentifiable_target_parameters</a> (TargetT &amp;target, const float value) const</td></tr>
<tr class="separator:a59e1af7b4bedf6fc9114a8bb54db1c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Functions to set parameters</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>This can be used as alternative to the parsing mechanism. </p><dl class="section warning"><dt>Warning</dt><dd>After using any of these, you have to call <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a3fe82f5f8802ddbede7798fef74d56ab" title="set-up sensitivity etc if possible ">set_up()</a>. </dd>
<dd>
Be careful with setting shared pointers. If you modify the objects in one place, all objects that use the shared pointer will be affected. </dd></dl>
</div></td></tr>
<tr class="memitem:a93a9bd607a386cb5fe9a2c72b40c28a1"><td class="memItemLeft" align="right" valign="top"><a id="a93a9bd607a386cb5fe9a2c72b40c28a1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_recompute_sensitivity</b> (const bool)</td></tr>
<tr class="separator:a93a9bd607a386cb5fe9a2c72b40c28a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80a287f78ff34cbb29600b6a55fd6cb9"><td class="memItemLeft" align="right" valign="top"><a id="a80a287f78ff34cbb29600b6a55fd6cb9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_subset_sensitivity_sptr</b> (const shared_ptr&lt; TargetT &gt; &amp;, const int subset_num)</td></tr>
<tr class="separator:a80a287f78ff34cbb29600b6a55fd6cb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2fc52ea6db5292110fbd7ba777ba02e"><td class="memItemLeft" align="right" valign="top"><a id="ac2fc52ea6db5292110fbd7ba777ba02e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#ac2fc52ea6db5292110fbd7ba777ba02e">set_use_subset_sensitivities</a> (const bool)</td></tr>
<tr class="memdesc:ac2fc52ea6db5292110fbd7ba777ba02e"><td class="mdescLeft">&#160;</td><td class="mdescRight">See <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a62f270d7bd5b0ef331c702ed5e6815c7" title="find out if subset_sensitivities are used ">get_use_subset_sensitivities()</a> <br /></td></tr>
<tr class="separator:ac2fc52ea6db5292110fbd7ba777ba02e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a9f92f3f0a777639c0656fe4e8acb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a20a9f92f3f0a777639c0656fe4e8acb3">set_sensitivity_filename</a> (const std::string &amp;)</td></tr>
<tr class="memdesc:a20a9f92f3f0a777639c0656fe4e8acb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">set filename to read (or write) the total sensitivity  <a href="#a20a9f92f3f0a777639c0656fe4e8acb3">More...</a><br /></td></tr>
<tr class="separator:a20a9f92f3f0a777639c0656fe4e8acb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45ae5ad2c2c78cf24a1a95a633e67ab9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a45ae5ad2c2c78cf24a1a95a633e67ab9">set_subsensitivity_filenames</a> (const std::string &amp;)</td></tr>
<tr class="memdesc:a45ae5ad2c2c78cf24a1a95a633e67ab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">set filename pattern to read (or write) the subset sensitivities  <a href="#a45ae5ad2c2c78cf24a1a95a633e67ab9">More...</a><br /></td></tr>
<tr class="separator:a45ae5ad2c2c78cf24a1a95a633e67ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classstir_1_1GeneralisedObjectiveFunction')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html">stir::GeneralisedObjectiveFunction&lt; TargetT &gt;</a></td></tr>
<tr class="memitem:ac7d1bb65ad36569c4e78d81745e7db07 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="ac7d1bb65ad36569c4e78d81745e7db07"></a>
virtual TargetT *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#ac7d1bb65ad36569c4e78d81745e7db07">construct_target_ptr</a> () const =0</td></tr>
<tr class="memdesc:ac7d1bb65ad36569c4e78d81745e7db07 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a suitable target as determined by the parameters. <br /></td></tr>
<tr class="separator:ac7d1bb65ad36569c4e78d81745e7db07 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6291a5e5373517ddfb7ccbc259fdeef6 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a6291a5e5373517ddfb7ccbc259fdeef6">compute_sub_gradient</a> (TargetT &amp;gradient, const TargetT &amp;current_estimate, const int subset_num)</td></tr>
<tr class="memdesc:a6291a5e5373517ddfb7ccbc259fdeef6 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">This should compute the sub-gradient of the objective function at the <em>current_estimate</em>.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a6291a5e5373517ddfb7ccbc259fdeef6">More...</a><br /></td></tr>
<tr class="separator:a6291a5e5373517ddfb7ccbc259fdeef6 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de6d1650b0eb144a73941a5f0ade96b inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a2de6d1650b0eb144a73941a5f0ade96b">compute_objective_function_without_penalty</a> (const TargetT &amp;current_estimate, const int subset_num)</td></tr>
<tr class="memdesc:a2de6d1650b0eb144a73941a5f0ade96b inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value of the unregularised sub-objective function at the <em>current_estimate</em>.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a2de6d1650b0eb144a73941a5f0ade96b">More...</a><br /></td></tr>
<tr class="separator:a2de6d1650b0eb144a73941a5f0ade96b inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b4fabaae9c18869ae00efa6f74ab57f inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a2b4fabaae9c18869ae00efa6f74ab57f">compute_objective_function_without_penalty</a> (const TargetT &amp;current_estimate)</td></tr>
<tr class="memdesc:a2b4fabaae9c18869ae00efa6f74ab57f inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value of the unregularised objective function at the <em>current_estimate</em>.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a2b4fabaae9c18869ae00efa6f74ab57f">More...</a><br /></td></tr>
<tr class="separator:a2b4fabaae9c18869ae00efa6f74ab57f inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77ce28ba6826afc2fbd303b65946b6d4 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a77ce28ba6826afc2fbd303b65946b6d4">compute_penalty</a> (const TargetT &amp;current_estimate, const int subset_num)</td></tr>
<tr class="memdesc:a77ce28ba6826afc2fbd303b65946b6d4 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value of the sub-penalty at the <em>current_estimate</em>.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a77ce28ba6826afc2fbd303b65946b6d4">More...</a><br /></td></tr>
<tr class="separator:a77ce28ba6826afc2fbd303b65946b6d4 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a159b743f71bd2be8dc5441ecf580d373 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a159b743f71bd2be8dc5441ecf580d373">compute_penalty</a> (const TargetT &amp;current_estimate)</td></tr>
<tr class="memdesc:a159b743f71bd2be8dc5441ecf580d373 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value of the penalty at the <em>current_estimate</em>.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a159b743f71bd2be8dc5441ecf580d373">More...</a><br /></td></tr>
<tr class="separator:a159b743f71bd2be8dc5441ecf580d373 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a211f21d59b7d47f605a2f38a643bda68 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a211f21d59b7d47f605a2f38a643bda68">compute_objective_function</a> (const TargetT &amp;current_estimate, const int subset_num)</td></tr>
<tr class="memdesc:a211f21d59b7d47f605a2f38a643bda68 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value of the sub-objective function at the <em>current_estimate</em>.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a211f21d59b7d47f605a2f38a643bda68">More...</a><br /></td></tr>
<tr class="separator:a211f21d59b7d47f605a2f38a643bda68 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9fd305b3f3b5070ee5c7b62e8b5fee5 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#af9fd305b3f3b5070ee5c7b62e8b5fee5">compute_objective_function</a> (const TargetT &amp;current_estimate)</td></tr>
<tr class="memdesc:af9fd305b3f3b5070ee5c7b62e8b5fee5 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value of the objective function at the <em>current_estimate</em>.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#af9fd305b3f3b5070ee5c7b62e8b5fee5">More...</a><br /></td></tr>
<tr class="separator:af9fd305b3f3b5070ee5c7b62e8b5fee5 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a552fa05a71b2b3c533e9c5d987bf7066 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="a552fa05a71b2b3c533e9c5d987bf7066"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a552fa05a71b2b3c533e9c5d987bf7066">get_objective_function_values_report</a> (const TargetT &amp;current_estimate)</td></tr>
<tr class="memdesc:a552fa05a71b2b3c533e9c5d987bf7066 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a string with info on the value of objective function with and without penalty. <br /></td></tr>
<tr class="separator:a552fa05a71b2b3c533e9c5d987bf7066 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72704e313651d0d4d7a61846df7a8f47 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="a72704e313651d0d4d7a61846df7a8f47"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a72704e313651d0d4d7a61846df7a8f47">get_num_subsets</a> () const</td></tr>
<tr class="memdesc:a72704e313651d0d4d7a61846df7a8f47 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of subsets in-use. <br /></td></tr>
<tr class="separator:a72704e313651d0d4d7a61846df7a8f47 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4712dc126b185ab17926283c3331ec2c inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a4712dc126b185ab17926283c3331ec2c">set_num_subsets</a> (const int num_subsets)=0</td></tr>
<tr class="memdesc:a4712dc126b185ab17926283c3331ec2c inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempts to change the number of subsets.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a4712dc126b185ab17926283c3331ec2c">More...</a><br /></td></tr>
<tr class="separator:a4712dc126b185ab17926283c3331ec2c inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44734aea00b7cf5ce40fd8f21367e9d5 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a44734aea00b7cf5ce40fd8f21367e9d5">subsets_are_approximately_balanced</a> () const</td></tr>
<tr class="memdesc:a44734aea00b7cf5ce40fd8f21367e9d5 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks of the current subset scheme is approximately balanced.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a44734aea00b7cf5ce40fd8f21367e9d5">More...</a><br /></td></tr>
<tr class="separator:a44734aea00b7cf5ce40fd8f21367e9d5 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a655f803224f2de4512bc144b7d67ca84 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a655f803224f2de4512bc144b7d67ca84">subsets_are_approximately_balanced</a> (std::string &amp;warning_message) const</td></tr>
<tr class="memdesc:a655f803224f2de4512bc144b7d67ca84 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks of the current subset scheme is approximately balanced and constructs a warning message.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a655f803224f2de4512bc144b7d67ca84">More...</a><br /></td></tr>
<tr class="separator:a655f803224f2de4512bc144b7d67ca84 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dddd10a1aa250e6c0d6d3365e1636b8 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="a1dddd10a1aa250e6c0d6d3365e1636b8"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a1dddd10a1aa250e6c0d6d3365e1636b8">prior_is_zero</a> () const</td></tr>
<tr class="memdesc:a1dddd10a1aa250e6c0d6d3365e1636b8 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if the prior is set (or the penalisation factor is 0) <br /></td></tr>
<tr class="separator:a1dddd10a1aa250e6c0d6d3365e1636b8 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c99dc70801b4cc6e909794f3889bb5f inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstir_1_1GeneralisedPrior.html">GeneralisedPrior</a>&lt; TargetT &gt; *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a9c99dc70801b4cc6e909794f3889bb5f">get_prior_ptr</a> () const</td></tr>
<tr class="memdesc:a9c99dc70801b4cc6e909794f3889bb5f inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read-only access to the prior.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a9c99dc70801b4cc6e909794f3889bb5f">More...</a><br /></td></tr>
<tr class="separator:a9c99dc70801b4cc6e909794f3889bb5f inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a711bf385ed5b222b7ea2f77b09db3c0a inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="a711bf385ed5b222b7ea2f77b09db3c0a"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1GeneralisedPrior.html">GeneralisedPrior</a>&lt; TargetT &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_prior_sptr</b> ()</td></tr>
<tr class="separator:a711bf385ed5b222b7ea2f77b09db3c0a inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a8d1df3d531d94ed262c051b10c36b5 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a9a8d1df3d531d94ed262c051b10c36b5">set_prior_sptr</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1GeneralisedPrior.html">GeneralisedPrior</a>&lt; TargetT &gt; &gt; &amp;)</td></tr>
<tr class="memdesc:a9a8d1df3d531d94ed262c051b10c36b5 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the prior.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a9a8d1df3d531d94ed262c051b10c36b5">More...</a><br /></td></tr>
<tr class="separator:a9a8d1df3d531d94ed262c051b10c36b5 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a191d2641fe116852e66c99212fde3b50 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a191d2641fe116852e66c99212fde3b50">set_input_data</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1ExamData.html">ExamData</a> &gt; &amp;)=0</td></tr>
<tr class="memdesc:a191d2641fe116852e66c99212fde3b50 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">set_input_data  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a191d2641fe116852e66c99212fde3b50">More...</a><br /></td></tr>
<tr class="separator:a191d2641fe116852e66c99212fde3b50 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8304392cf449fbe3bfbb490ddc74bb1d inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classstir_1_1ExamData.html">ExamData</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a8304392cf449fbe3bfbb490ddc74bb1d">get_input_data</a> () const =0</td></tr>
<tr class="memdesc:a8304392cf449fbe3bfbb490ddc74bb1d inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">get input data  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a8304392cf449fbe3bfbb490ddc74bb1d">More...</a><br /></td></tr>
<tr class="separator:a8304392cf449fbe3bfbb490ddc74bb1d inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9605e9d34ed5d9851951ea0d9ffb4862 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a9605e9d34ed5d9851951ea0d9ffb4862">set_additive_proj_data_sptr</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1ExamData.html">ExamData</a> &gt; &amp;)=0</td></tr>
<tr class="memdesc:a9605e9d34ed5d9851951ea0d9ffb4862 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">set_additive_proj_data_sptr  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a9605e9d34ed5d9851951ea0d9ffb4862">More...</a><br /></td></tr>
<tr class="separator:a9605e9d34ed5d9851951ea0d9ffb4862 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b4e611dcb36d3d690e64939e46d2dd inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#ae8b4e611dcb36d3d690e64939e46d2dd">set_normalisation_sptr</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1BinNormalisation.html">BinNormalisation</a> &gt; &amp;)=0</td></tr>
<tr class="memdesc:ae8b4e611dcb36d3d690e64939e46d2dd inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">set_normalisation_sptr  <a href="classstir_1_1GeneralisedObjectiveFunction.html#ae8b4e611dcb36d3d690e64939e46d2dd">More...</a><br /></td></tr>
<tr class="separator:ae8b4e611dcb36d3d690e64939e46d2dd inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3539db92b08bb08e3d5f700f523d943 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstir_1_1Succeeded.html">Succeeded</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#ae3539db92b08bb08e3d5f700f523d943">add_multiplication_with_approximate_sub_Hessian_without_penalty</a> (TargetT &amp;output, const TargetT &amp;input, const int subset_num) const</td></tr>
<tr class="memdesc:ae3539db92b08bb08e3d5f700f523d943 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions that multiply the (sub)Hessian with a \'vector\'.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#ae3539db92b08bb08e3d5f700f523d943">More...</a><br /></td></tr>
<tr class="separator:ae3539db92b08bb08e3d5f700f523d943 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01131b722a97e3c6595d8691c7ca21b inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="ad01131b722a97e3c6595d8691c7ca21b"></a>
<a class="el" href="classstir_1_1Succeeded.html">Succeeded</a>&#160;</td><td class="memItemRight" valign="bottom"><b>add_multiplication_with_approximate_sub_Hessian</b> (TargetT &amp;output, const TargetT &amp;input, const int subset_num) const</td></tr>
<tr class="separator:ad01131b722a97e3c6595d8691c7ca21b inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab546c728727fbce8a4c49e6dc2b2a0f2 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="ab546c728727fbce8a4c49e6dc2b2a0f2"></a>
<a class="el" href="classstir_1_1Succeeded.html">Succeeded</a>&#160;</td><td class="memItemRight" valign="bottom"><b>add_multiplication_with_approximate_Hessian_without_penalty</b> (TargetT &amp;output, const TargetT &amp;input) const</td></tr>
<tr class="separator:ab546c728727fbce8a4c49e6dc2b2a0f2 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae569195e094f31dbde1571a73ae96842 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="ae569195e094f31dbde1571a73ae96842"></a>
<a class="el" href="classstir_1_1Succeeded.html">Succeeded</a>&#160;</td><td class="memItemRight" valign="bottom"><b>add_multiplication_with_approximate_Hessian</b> (TargetT &amp;output, const TargetT &amp;input) const</td></tr>
<tr class="separator:ae569195e094f31dbde1571a73ae96842 inherit pub_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classstir_1_1RegisteredObjectBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classstir_1_1RegisteredObjectBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classstir_1_1RegisteredObjectBase.html">stir::RegisteredObjectBase</a></td></tr>
<tr class="memitem:a9eb7d6e93407316c0780e2121e522ae4 inherit pub_methods_classstir_1_1RegisteredObjectBase"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1RegisteredObjectBase.html#a9eb7d6e93407316c0780e2121e522ae4">get_registered_name</a> () const =0</td></tr>
<tr class="memdesc:a9eb7d6e93407316c0780e2121e522ae4 inherit pub_methods_classstir_1_1RegisteredObjectBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the name of the type of the object.  <a href="classstir_1_1RegisteredObjectBase.html#a9eb7d6e93407316c0780e2121e522ae4">More...</a><br /></td></tr>
<tr class="separator:a9eb7d6e93407316c0780e2121e522ae4 inherit pub_methods_classstir_1_1RegisteredObjectBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classstir_1_1ParsingObject"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classstir_1_1ParsingObject')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classstir_1_1ParsingObject.html">stir::ParsingObject</a></td></tr>
<tr class="memitem:a15b8a585ba2b09674b823446bf8481bf inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="a15b8a585ba2b09674b823446bf8481bf"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ParsingObject</b> (const <a class="el" href="classstir_1_1ParsingObject.html">ParsingObject</a> &amp;)</td></tr>
<tr class="separator:a15b8a585ba2b09674b823446bf8481bf inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20920a86db3428de6fd40381ef50aba4 inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="a20920a86db3428de6fd40381ef50aba4"></a>
<a class="el" href="classstir_1_1ParsingObject.html">ParsingObject</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classstir_1_1ParsingObject.html">ParsingObject</a> &amp;)</td></tr>
<tr class="separator:a20920a86db3428de6fd40381ef50aba4 inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a268a7806a6ad7c78ec43f21582627163 inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="a268a7806a6ad7c78ec43f21582627163"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ask_parameters</b> ()</td></tr>
<tr class="separator:a268a7806a6ad7c78ec43f21582627163 inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf7dc9a4725e6e6673b5cf36f8433a0b inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="acf7dc9a4725e6e6673b5cf36f8433a0b"></a>
virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><b>parameter_info</b> ()</td></tr>
<tr class="separator:acf7dc9a4725e6e6673b5cf36f8433a0b inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8597c63ee9c4e5c927117daf35f2b129 inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="a8597c63ee9c4e5c927117daf35f2b129"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>parse</b> (std::istream &amp;f)</td></tr>
<tr class="separator:a8597c63ee9c4e5c927117daf35f2b129 inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedc5f10739c1dfb78fecd33c74d7d643 inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="aedc5f10739c1dfb78fecd33c74d7d643"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>parse</b> (const char *const filename)</td></tr>
<tr class="separator:aedc5f10739c1dfb78fecd33c74d7d643 inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a0a1a8f88c15f3494b95da9e5efc74db1"><td class="memItemLeft" align="right" valign="top"><a id="a0a1a8f88c15f3494b95da9e5efc74db1"></a>
virtual <a class="el" href="classstir_1_1Succeeded.html">Succeeded</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a0a1a8f88c15f3494b95da9e5efc74db1">set_up_before_sensitivity</a> (shared_ptr&lt; TargetT &gt; const &amp;target_sptr)=0</td></tr>
<tr class="memdesc:a0a1a8f88c15f3494b95da9e5efc74db1"><td class="mdescLeft">&#160;</td><td class="mdescRight">set-up specifics for the derived class <br /></td></tr>
<tr class="separator:a0a1a8f88c15f3494b95da9e5efc74db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570f421f50cc62bdd8bef78923982396"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a570f421f50cc62bdd8bef78923982396">compute_sensitivities</a> ()</td></tr>
<tr class="memdesc:a570f421f50cc62bdd8bef78923982396"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute subset and total sensitivity  <a href="#a570f421f50cc62bdd8bef78923982396">More...</a><br /></td></tr>
<tr class="separator:a570f421f50cc62bdd8bef78923982396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7844fed4568a1237110fec8d066e0de"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#ad7844fed4568a1237110fec8d066e0de">set_defaults</a> ()</td></tr>
<tr class="memdesc:ad7844fed4568a1237110fec8d066e0de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets defaults for parsing.  <a href="#ad7844fed4568a1237110fec8d066e0de">More...</a><br /></td></tr>
<tr class="separator:ad7844fed4568a1237110fec8d066e0de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f69f3b77d29500723bd5aa573f85c48"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a9f69f3b77d29500723bd5aa573f85c48">initialise_keymap</a> ()</td></tr>
<tr class="memdesc:a9f69f3b77d29500723bd5aa573f85c48"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets parsing keys  <a href="#a9f69f3b77d29500723bd5aa573f85c48">More...</a><br /></td></tr>
<tr class="separator:a9f69f3b77d29500723bd5aa573f85c48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d3ad1311f0f0eb8a9f2ec874c133fae"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a6d3ad1311f0f0eb8a9f2ec874c133fae">post_processing</a> ()</td></tr>
<tr class="memdesc:a6d3ad1311f0f0eb8a9f2ec874c133fae"><td class="mdescLeft">&#160;</td><td class="mdescRight">This will be called at the end of the parsing.  <a href="#a6d3ad1311f0f0eb8a9f2ec874c133fae">More...</a><br /></td></tr>
<tr class="separator:a6d3ad1311f0f0eb8a9f2ec874c133fae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classstir_1_1GeneralisedObjectiveFunction')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html">stir::GeneralisedObjectiveFunction&lt; TargetT &gt;</a></td></tr>
<tr class="memitem:a89a46ab8367116185a14645f5b22cc85 inherit pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a89a46ab8367116185a14645f5b22cc85">actual_subsets_are_approximately_balanced</a> (std::string &amp;warning_message) const =0</td></tr>
<tr class="memdesc:a89a46ab8367116185a14645f5b22cc85 inherit pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of function that checks subset balancing.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a89a46ab8367116185a14645f5b22cc85">More...</a><br /></td></tr>
<tr class="separator:a89a46ab8367116185a14645f5b22cc85 inherit pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f19e8ac5807a8b3166524132d618095 inherit pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a1f19e8ac5807a8b3166524132d618095">actual_compute_objective_function_without_penalty</a> (const TargetT &amp;current_estimate, const int subset_num)=0</td></tr>
<tr class="memdesc:a1f19e8ac5807a8b3166524132d618095 inherit pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of function that computes the objective function for the current subset.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#a1f19e8ac5807a8b3166524132d618095">More...</a><br /></td></tr>
<tr class="separator:a1f19e8ac5807a8b3166524132d618095 inherit pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae22977c2003d551fc3e9a743b105725 inherit pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classstir_1_1Succeeded.html">Succeeded</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#aae22977c2003d551fc3e9a743b105725">actual_add_multiplication_with_approximate_sub_Hessian_without_penalty</a> (TargetT &amp;output, const TargetT &amp;input, const int subset_num) const</td></tr>
<tr class="memdesc:aae22977c2003d551fc3e9a743b105725 inherit pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of the function that multiplies the sub-Hessian with a vector.  <a href="classstir_1_1GeneralisedObjectiveFunction.html#aae22977c2003d551fc3e9a743b105725">More...</a><br /></td></tr>
<tr class="separator:aae22977c2003d551fc3e9a743b105725 inherit pro_methods_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classstir_1_1ParsingObject"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classstir_1_1ParsingObject')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classstir_1_1ParsingObject.html">stir::ParsingObject</a></td></tr>
<tr class="memitem:ad8e81786834c010c96c31bce2bac3f6d inherit pro_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ParsingObject.html#ad8e81786834c010c96c31bce2bac3f6d">set_key_values</a> ()</td></tr>
<tr class="memdesc:ad8e81786834c010c96c31bce2bac3f6d inherit pro_methods_classstir_1_1ParsingObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">This will be called before parsing or parameter_info is called.  <a href="classstir_1_1ParsingObject.html#ad8e81786834c010c96c31bce2bac3f6d">More...</a><br /></td></tr>
<tr class="separator:ad8e81786834c010c96c31bce2bac3f6d inherit pro_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_classstir_1_1RegisteredObject"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classstir_1_1RegisteredObject')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classstir_1_1RegisteredObject.html">stir::RegisteredObject&lt; GeneralisedObjectiveFunction&lt; TargetT &gt; &gt;</a></td></tr>
<tr class="memitem:aa32357a52b98c87a1c38a162355c874e inherit pub_static_methods_classstir_1_1RegisteredObject"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html">GeneralisedObjectiveFunction</a>&lt; TargetT &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1RegisteredObject.html#aa32357a52b98c87a1c38a162355c874e">read_registered_object</a> (std::istream *in, const std::string &amp;registered_name)</td></tr>
<tr class="memdesc:aa32357a52b98c87a1c38a162355c874e inherit pub_static_methods_classstir_1_1RegisteredObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new object (of a type derived from Root, its actual type determined by the registered_name parameter) by parsing the istream.  <a href="classstir_1_1RegisteredObject.html#aa32357a52b98c87a1c38a162355c874e">More...</a><br /></td></tr>
<tr class="separator:aa32357a52b98c87a1c38a162355c874e inherit pub_static_methods_classstir_1_1RegisteredObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20ba04aadc52e375e5e97961ddb8f5e1 inherit pub_static_methods_classstir_1_1RegisteredObject"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html">GeneralisedObjectiveFunction</a>&lt; TargetT &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1RegisteredObject.html#a20ba04aadc52e375e5e97961ddb8f5e1">ask_type_and_parameters</a> ()</td></tr>
<tr class="memdesc:a20ba04aadc52e375e5e97961ddb8f5e1 inherit pub_static_methods_classstir_1_1RegisteredObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">ask the user for the type, and then calls read_registered_object(0, type)  <a href="classstir_1_1RegisteredObject.html#a20ba04aadc52e375e5e97961ddb8f5e1">More...</a><br /></td></tr>
<tr class="separator:a20ba04aadc52e375e5e97961ddb8f5e1 inherit pub_static_methods_classstir_1_1RegisteredObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7946572a60fac083300e2baaf650d6b8 inherit pub_static_methods_classstir_1_1RegisteredObject"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1RegisteredObject.html#a7946572a60fac083300e2baaf650d6b8">list_registered_names</a> (std::ostream &amp;stream)</td></tr>
<tr class="memdesc:a7946572a60fac083300e2baaf650d6b8 inherit pub_static_methods_classstir_1_1RegisteredObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">List all possible registered names to the stream.  <a href="classstir_1_1RegisteredObject.html#a7946572a60fac083300e2baaf650d6b8">More...</a><br /></td></tr>
<tr class="separator:a7946572a60fac083300e2baaf650d6b8 inherit pub_static_methods_classstir_1_1RegisteredObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_types_classstir_1_1RegisteredObject"><td colspan="2" onclick="javascript:toggleInherit('pro_types_classstir_1_1RegisteredObject')"><img src="closed.png" alt="-"/>&#160;Protected Types inherited from <a class="el" href="classstir_1_1RegisteredObject.html">stir::RegisteredObject&lt; GeneralisedObjectiveFunction&lt; TargetT &gt; &gt;</a></td></tr>
<tr class="memitem:a4497941e1fe3ec79b7a75085d75488fb inherit pro_types_classstir_1_1RegisteredObject"><td class="memItemLeft" align="right" valign="top"><a id="a4497941e1fe3ec79b7a75085d75488fb"></a>
typedef <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html">GeneralisedObjectiveFunction</a>&lt; TargetT &gt; *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1RegisteredObject.html#a4497941e1fe3ec79b7a75085d75488fb">RootFactory</a>) (std::istream *)</td></tr>
<tr class="memdesc:a4497941e1fe3ec79b7a75085d75488fb inherit pro_types_classstir_1_1RegisteredObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of a root factory is a function, taking an istream* as argument, and returning a Root*. <br /></td></tr>
<tr class="separator:a4497941e1fe3ec79b7a75085d75488fb inherit pro_types_classstir_1_1RegisteredObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6dc41fd8a2cb0a5e1118aa32df98711 inherit pro_types_classstir_1_1RegisteredObject"><td class="memItemLeft" align="right" valign="top"><a id="aa6dc41fd8a2cb0a5e1118aa32df98711"></a>
typedef <a class="el" href="classstir_1_1FactoryRegistry.html">FactoryRegistry</a>&lt; std::string, <a class="el" href="classstir_1_1RegisteredObject.html#a4497941e1fe3ec79b7a75085d75488fb">RootFactory</a>, <a class="el" href="structstir_1_1interfile__less.html">interfile_less</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1RegisteredObject.html#aa6dc41fd8a2cb0a5e1118aa32df98711">RegistryType</a></td></tr>
<tr class="memdesc:aa6dc41fd8a2cb0a5e1118aa32df98711 inherit pro_types_classstir_1_1RegisteredObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of the registry. <br /></td></tr>
<tr class="separator:aa6dc41fd8a2cb0a5e1118aa32df98711 inherit pro_types_classstir_1_1RegisteredObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_classstir_1_1RegisteredObject"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classstir_1_1RegisteredObject')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classstir_1_1RegisteredObject.html">stir::RegisteredObject&lt; GeneralisedObjectiveFunction&lt; TargetT &gt; &gt;</a></td></tr>
<tr class="memitem:a480c831d74fb41ff32787a908a07bbd3 inherit pro_static_methods_classstir_1_1RegisteredObject"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classstir_1_1RegisteredObject.html#aa6dc41fd8a2cb0a5e1118aa32df98711">RegistryType</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1RegisteredObject.html#a480c831d74fb41ff32787a908a07bbd3">registry</a> ()</td></tr>
<tr class="memdesc:a480c831d74fb41ff32787a908a07bbd3 inherit pro_static_methods_classstir_1_1RegisteredObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Static function returning the registry.  <a href="classstir_1_1RegisteredObject.html#a480c831d74fb41ff32787a908a07bbd3">More...</a><br /></td></tr>
<tr class="separator:a480c831d74fb41ff32787a908a07bbd3 inherit pro_static_methods_classstir_1_1RegisteredObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classstir_1_1GeneralisedObjectiveFunction"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classstir_1_1GeneralisedObjectiveFunction')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html">stir::GeneralisedObjectiveFunction&lt; TargetT &gt;</a></td></tr>
<tr class="memitem:a0c290bd64ac9b2018ba2d994590aaec2 inherit pro_attribs_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="a0c290bd64ac9b2018ba2d994590aaec2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>num_subsets</b></td></tr>
<tr class="separator:a0c290bd64ac9b2018ba2d994590aaec2 inherit pro_attribs_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1171c563e716259820f59706353bf7b3 inherit pro_attribs_classstir_1_1GeneralisedObjectiveFunction"><td class="memItemLeft" align="right" valign="top"><a id="a1171c563e716259820f59706353bf7b3"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1GeneralisedPrior.html">GeneralisedPrior</a>&lt; TargetT &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>prior_sptr</b></td></tr>
<tr class="separator:a1171c563e716259820f59706353bf7b3 inherit pro_attribs_classstir_1_1GeneralisedObjectiveFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classstir_1_1ParsingObject"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classstir_1_1ParsingObject')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classstir_1_1ParsingObject.html">stir::ParsingObject</a></td></tr>
<tr class="memitem:ac53aef0f7ecd5dbb6204239b14e657f8 inherit pro_attribs_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="ac53aef0f7ecd5dbb6204239b14e657f8"></a>
<a class="el" href="classstir_1_1KeyParser.html">KeyParser</a>&#160;</td><td class="memItemRight" valign="bottom"><b>parser</b></td></tr>
<tr class="separator:ac53aef0f7ecd5dbb6204239b14e657f8 inherit pro_attribs_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename TargetT&gt;<br />
class stir::PoissonLogLikelihoodWithLinearModelForMean&lt; TargetT &gt;</h3>

<p>a base class for LogLikelihood of independent Poisson variables where the mean values are linear combinations of the parameters. </p>
<p>Suppose the measured data <img class="formulaInl" alt="$y$" src="form_53.png"/> are statistically independent and Poisson distributed with mean <img class="formulaInl" alt="$\bar y$" src="form_54.png"/>. The log likelihood is then given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ L(y\;\bar y) = \sum_b y_b log \bar y_b - \mathrm{log} y_b! - \bar y_b \]" src="form_55.png"/>
</p>
<p>If the means are modeled by some functions of some parameters <img class="formulaInl" alt="$Y(\lambda)$" src="form_56.png"/>, the gradient w.r.t. those parameters follows immediately as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\partial L \over \partial \lambda_v} = \sum_b \left( {y_b \over Y_b} - 1 \right) {\partial Y_b \over \partial \lambda_v } \]" src="form_57.png"/>
</p>
<p>In this class, it is assumed that the means are linear functions of the parameters, which using matrices and vectors can be written (in a notation familiar to PET people) as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ Y = P \lambda + r \]" src="form_58.png"/>
</p>
<p>If the background term <img class="formulaInl" alt="$r$" src="form_59.png"/> is 0, <img class="formulaInl" alt="$P_{bv}$" src="form_60.png"/> gives the conditional probability of detecting a count in bin <img class="formulaInl" alt="$b$" src="form_61.png"/> if the parameter <img class="formulaInl" alt="$\lambda_v$" src="form_62.png"/> is 1 and all others 0.</p>
<p>In this case, the gradient is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\partial L \over \partial \lambda_v} = \sum_b P_{bv} {y_b \over Y_b} - P_v \]" src="form_63.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ P_v = \sum_b P_{bv} \]" src="form_64.png"/>
</p>
<p> where the sum is over all possible bins (not only those where any counts were detected). We call the vector given by <img class="formulaInl" alt="$P_v$" src="form_65.png"/> the <em>sensitivity</em> because (if <img class="formulaInl" alt="$r=0$" src="form_66.png"/>) it is the total probability of detecting a count (in any bin) originating from <img class="formulaInl" alt="$v$" src="form_67.png"/>.</p>
<p>This class computes the gradient as a sum of these two terms. The sensitivity has to be computed by the virtual function <code><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a5fb55b3cf0e61134eaf21f44c7420c98" title="Add subset sensitivity to existing data. ">add_subset_sensitivity()</a></code>. The sum is computed by <code><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a1be81e2443e163294c4ec6cb722160aa" title="This should compute the gradient of the (unregularised) objective function plus the (sub)sensitivity...">compute_sub_gradient_without_penalty_plus_sensitivity()</a></code>.</p>
<p>The reason for this is that the sensitivity is data-independent, and can be computed only once. See also <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeData.html" title="An objective function class appropriate for PET list mode data. ">PoissonLogLikelihoodWithLinearModelForMeanAndListModeData</a>.</p>
<dl class="section user"><dt>Relation with Kullback-Leibler distance</dt><dd></dd></dl>
<p>Note that up to terms independent of <img class="formulaInl" alt="$\bar y$" src="form_54.png"/>, the log likelihood is equal to minus the Kullback-Leibler generalised distance</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathrm{KL}(y,\bar y) = \sum_b y_b \mathrm{log}(y_b/\bar y_b) + \bar y_b - y_b \]" src="form_68.png"/>
</p>
<p>which has the nice property that <img class="formulaInl" alt="$\mathrm{KL}(y,\bar y)=0$" src="form_69.png"/> implies that <img class="formulaInl" alt="$y=\bar y$" src="form_70.png"/>.</p>
<dl class="section user"><dt>Parameters for parsing</dt><dd>Defaults are indicated below <pre class="fragment">; specifies if we keep separate sensitivity images (which is more accurate and is 
; recommended) or if we assume the subsets are exactly balanced 
; and hence compute the subset-senstivity as sensitivity/num_subsets (this uses less memory).
use_subset_sensitivities := 1
; for recomputing sensitivity, even if a filename is specified
recompute sensitivity:= 0
; filename for reading the sensitivity, or writing if it is recomputed
; if use_subset_sensitivities=0
sensitivity filename:=
; pattern for filename for reading the subset sensitivities, or writing if recomputed
; if use_subset_sensitivities=1
; e.g. subsens_%d.hv
; boost::format is used with the pattern (which means you can use it like sprintf)
subset sensitivity filenames:=
</pre></dd></dl>
<dl class="section user"><dt>Terminology</dt><dd>We currently use <code>sub_gradient</code> for the gradient of the likelihood of the subset (not the mathematical subgradient). </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a351a7cf4f32a62dc9c1bbdd5d5e0aee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a351a7cf4f32a62dc9c1bbdd5d5e0aee7">&#9670;&nbsp;</a></span>compute_sub_gradient_without_penalty()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::compute_sub_gradient_without_penalty </td>
          <td>(</td>
          <td class="paramtype">TargetT &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TargetT &amp;&#160;</td>
          <td class="paramname"><em>current_estimate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>subset_num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implementation in terms of <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a1be81e2443e163294c4ec6cb722160aa" title="This should compute the gradient of the (unregularised) objective function plus the (sub)sensitivity...">compute_sub_gradient_without_penalty_plus_sensitivity()</a> </p>
<dl class="section warning"><dt>Warning</dt><dd>If separate subsensitivities are not used, we just subtract the total sensitivity divided by the number of subsets. This is fine for some algorithms as the sum over all the subsets is equal to gradient of the objective function (without prior). Other algorithms do not behave very stable under this approximation however. So, currently setup() will return an error if <code>!subsets_are_approximately_balanced()</code> and subset sensitivities are not used.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a62f270d7bd5b0ef331c702ed5e6815c7" title="find out if subset_sensitivities are used ">get_use_subset_sensitivities()</a> </dd></dl>

<p>Implements <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a3d490db9b1171fc0fa198c93af4d78cb">stir::GeneralisedObjectiveFunction&lt; TargetT &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="classstir_1_1SumOfGeneralisedObjectiveFunctions.html#ad0e1104f45c2b6c735e4a6d849184f28">stir::SumOfGeneralisedObjectiveFunctions&lt; PoissonLogLikelihoodWithLinearModelForMeanAndProjData&lt; TargetT &gt;, TargetT, PoissonLogLikelihoodWithLinearModelForMean&lt; TargetT &gt; &gt;</a>.</p>

<p class="reference">References <a class="el" href="group__buildblock.html#ga19b3ad285f04d613640a497f868b385f">stir::error()</a>.</p>

</div>
</div>
<a id="a1be81e2443e163294c4ec6cb722160aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1be81e2443e163294c4ec6cb722160aa">&#9670;&nbsp;</a></span>compute_sub_gradient_without_penalty_plus_sensitivity()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::compute_sub_gradient_without_penalty_plus_sensitivity </td>
          <td>(</td>
          <td class="paramtype">TargetT &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TargetT &amp;&#160;</td>
          <td class="paramname"><em>current_estimate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>subset_num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This should compute the gradient of the (unregularised) objective function plus the (sub)sensitivity. </p>
<p>This function is used for instance by OSMAPOSL.</p>
<p>This computes </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\partial L \over \partial \lambda_v} + P_v = \sum_b P_{bv} {y_b \over Y_b} \]" src="form_71.png"/>
</p>
<p> (see the class general documentation). The sum will however be restricted to a subset. </p>

<p>Implemented in <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndProjData.html#a4c7cb074bfbf2baea19867964049b079">stir::PoissonLogLikelihoodWithLinearModelForMeanAndProjData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion.html#a7d6b94874044728cfae994209901af9a">stir::PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion.html#a4cc92acd556741f1abfd162bd0bedb95">stir::PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeData.html#aa7488056a148612f6543321a51c2a2db">stir::PoissonLogLikelihoodWithLinearModelForMeanAndListModeData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearKineticModelAndDynamicProjectionData.html#ae2fa8de7964f84cd9990151e44669f62">stir::PoissonLogLikelihoodWithLinearKineticModelAndDynamicProjectionData&lt; TargetT &gt;</a>, and <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeDataWithProjMatrixByBin.html#a9a74079256651dc7b36e0566757b5534">stir::PoissonLogLikelihoodWithLinearModelForMeanAndListModeDataWithProjMatrixByBin&lt; TargetT &gt;</a>.</p>

</div>
</div>
<a id="a3fe82f5f8802ddbede7798fef74d56ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fe82f5f8802ddbede7798fef74d56ab">&#9670;&nbsp;</a></span>set_up()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstir_1_1Succeeded.html">Succeeded</a> <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::set_up </td>
          <td>(</td>
          <td class="paramtype">shared_ptr&lt; TargetT &gt; const &amp;&#160;</td>
          <td class="paramname"><em>target_sptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set-up sensitivity etc if possible </p>
<p>If <code>recompute_sensitivity</code> is <code>false</code>, we will try to read it from either <code>subset_sensitivity_filenames</code> or <code>sensitivity_filename</code>, depending on the setting of <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a62f270d7bd5b0ef331c702ed5e6815c7" title="find out if subset_sensitivities are used ">get_use_subset_sensitivities()</a>.</p>
<p>If <code>sensitivity_filename</code> is equal to <code>&quot;1&quot;</code>, all data are set to <code>1</code>.</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000020">Deprecated:</a></b></dt><dd>This special handling of the string "1" will be removed later.</dd></dl>
<p>Calls <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a0a1a8f88c15f3494b95da9e5efc74db1" title="set-up specifics for the derived class ">set_up_before_sensitivity()</a>. </p>

<p>Reimplemented from <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a594bd9b807d2623fbf383d059140a808">stir::GeneralisedObjectiveFunction&lt; TargetT &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeData.html#af00d971bb7d4ff4c84f9319a7acc11b3">stir::PoissonLogLikelihoodWithLinearModelForMeanAndListModeData&lt; TargetT &gt;</a>, and <a class="el" href="classstir_1_1SumOfGeneralisedObjectiveFunctions.html#a132eaaf7eebec777c8ab6648d04ba6f6">stir::SumOfGeneralisedObjectiveFunctions&lt; PoissonLogLikelihoodWithLinearModelForMeanAndProjData&lt; TargetT &gt;, TargetT, PoissonLogLikelihoodWithLinearModelForMean&lt; TargetT &gt; &gt;</a>.</p>

<p class="reference">Referenced by <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndProjDataTests.html#a37849f0e3916941acd492012da72aed8">stir::PoissonLogLikelihoodWithLinearModelForMeanAndProjDataTests::run_tests_for_objective_function()</a>.</p>

</div>
</div>
<a id="a62f270d7bd5b0ef331c702ed5e6815c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62f270d7bd5b0ef331c702ed5e6815c7">&#9670;&nbsp;</a></span>get_use_subset_sensitivities()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::get_use_subset_sensitivities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find out if subset_sensitivities are used </p>
<p>If <code>true</code>, the sub_gradient and subset_sensitivity functions use the sensitivity for the given subset, otherwise, we use the total sensitivity divided by the number of subsets. The latter uses less memory, but is less stable for most (all?) algorithms. </p>

</div>
</div>
<a id="ad6d2e9bacac2ec151ef48552ab8cfe95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6d2e9bacac2ec151ef48552ab8cfe95">&#9670;&nbsp;</a></span>get_sensitivity_filename()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::get_sensitivity_filename </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get filename to read (or write) the total sensitivity </p>
<p>will be a zero string if not set </p>

</div>
</div>
<a id="a785b137dfe9c515f485ba847273cb183"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a785b137dfe9c515f485ba847273cb183">&#9670;&nbsp;</a></span>get_subsensitivity_filenames()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::get_subsensitivity_filenames </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get filename pattern to read (or write) the subset sensitivities </p>
<p>will be a zero string if not set. Could be e.g. "subsens_%d.hv" boost::format is used with the pattern (which means you can use it like sprintf) </p>

</div>
</div>
<a id="a20a9f92f3f0a777639c0656fe4e8acb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20a9f92f3f0a777639c0656fe4e8acb3">&#9670;&nbsp;</a></span>set_sensitivity_filename()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::set_sensitivity_filename </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set filename to read (or write) the total sensitivity </p>
<p>set to a zero-length string to avoid reading/writing a file </p>

</div>
</div>
<a id="a45ae5ad2c2c78cf24a1a95a633e67ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45ae5ad2c2c78cf24a1a95a633e67ab9">&#9670;&nbsp;</a></span>set_subsensitivity_filenames()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::set_subsensitivity_filenames </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filenames</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set filename pattern to read (or write) the subset sensitivities </p>
<p>set to a zero-length string to avoid reading/writing a file Could be e.g. "subsens_%d.hv" boost::format is used with the pattern (which means you can use it like sprintf)</p>
<p>Calls <a class="el" href="group__buildblock.html#ga19b3ad285f04d613640a497f868b385f" title="Print error with format string a la printf and throw exception. ">error()</a> if the pattern is invalid. </p>

<p class="reference">References <a class="el" href="group__buildblock.html#ga19b3ad285f04d613640a497f868b385f">stir::error()</a>.</p>

</div>
</div>
<a id="a59e1af7b4bedf6fc9114a8bb54db1c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e1af7b4bedf6fc9114a8bb54db1c56">&#9670;&nbsp;</a></span>fill_nonidentifiable_target_parameters()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::fill_nonidentifiable_target_parameters </td>
          <td>(</td>
          <td class="paramtype">TargetT &amp;&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The implementation checks if the sensitivity of a voxel is zero. If so, it will the target voxel will be assigned the desired value. </p>

<p>Reimplemented from <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#abe5bfcded32b6d3339b5bb1be1995c75">stir::GeneralisedObjectiveFunction&lt; TargetT &gt;</a>.</p>

</div>
</div>
<a id="a570f421f50cc62bdd8bef78923982396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a570f421f50cc62bdd8bef78923982396">&#9670;&nbsp;</a></span>compute_sensitivities()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::compute_sensitivities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>compute subset and total sensitivity </p>
<p>This function fills in the sensitivity data by calling <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html#a5fb55b3cf0e61134eaf21f44c7420c98" title="Add subset sensitivity to existing data. ">add_subset_sensitivity()</a> for all subsets. It assumes that the subsensitivity for the 1st subset has been allocated already (and is the correct size). </p>

<p class="reference">References <a class="el" href="group__buildblock.html#ga19b3ad285f04d613640a497f868b385f">stir::error()</a>.</p>

</div>
</div>
<a id="ad7844fed4568a1237110fec8d066e0de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7844fed4568a1237110fec8d066e0de">&#9670;&nbsp;</a></span>set_defaults()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::set_defaults </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets defaults for parsing. </p>
<p>Resets <code>sensitivity_filename</code>, <code>subset_sensitivity_filenames</code> to empty, <code>recompute_sensitivity</code> to <code>false</code>, and <code>use_subset_sensitivities</code> to false. </p>

<p>Reimplemented from <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#a1e679fbeb33210e7246fa377c571d29a">stir::GeneralisedObjectiveFunction&lt; TargetT &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndProjData.html#a583d1ee1f039d930595ce0f120db4485">stir::PoissonLogLikelihoodWithLinearModelForMeanAndProjData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion.html#a051c3bed2f95b1638c4f88a940a9a6d3">stir::PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearKineticModelAndDynamicProjectionData.html#ac8010fce0a5539f70569e4a345441c98">stir::PoissonLogLikelihoodWithLinearKineticModelAndDynamicProjectionData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndDynamicProjData.html#abcca67c186e40a1472040422406642db">stir::PoissonLogLikelihoodWithLinearModelForMeanAndDynamicProjData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeData.html#adcb33f6a20cf1d47a894a021d1dcba28">stir::PoissonLogLikelihoodWithLinearModelForMeanAndListModeData&lt; TargetT &gt;</a>, and <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeDataWithProjMatrixByBin.html#ae9690db25ae3941675b8fe774155d196">stir::PoissonLogLikelihoodWithLinearModelForMeanAndListModeDataWithProjMatrixByBin&lt; TargetT &gt;</a>.</p>

</div>
</div>
<a id="a9f69f3b77d29500723bd5aa573f85c48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f69f3b77d29500723bd5aa573f85c48">&#9670;&nbsp;</a></span>initialise_keymap()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::initialise_keymap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sets parsing keys </p>
<p>Has to be called by initialise_keymap in the leaf-class </p>

<p>Reimplemented from <a class="el" href="classstir_1_1GeneralisedObjectiveFunction.html#af598596a0703be897ce03c1eacf2dcda">stir::GeneralisedObjectiveFunction&lt; TargetT &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndProjData.html#a9c10597e3d07aebb58be302cfaabef4c">stir::PoissonLogLikelihoodWithLinearModelForMeanAndProjData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion.html#a0d71d054edded9ecc9c64c8c28a6472f">stir::PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearKineticModelAndDynamicProjectionData.html#a54dfbd3faf93ba25446dae9d707f52a3">stir::PoissonLogLikelihoodWithLinearKineticModelAndDynamicProjectionData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndDynamicProjData.html#a6d28e22184066e46219ebd3846e84cc1">stir::PoissonLogLikelihoodWithLinearModelForMeanAndDynamicProjData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeData.html#a3ab0cd058d62345bb6638366b8389136">stir::PoissonLogLikelihoodWithLinearModelForMeanAndListModeData&lt; TargetT &gt;</a>, and <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeDataWithProjMatrixByBin.html#a54732f19892dd5cb1c024fafd9c0655a">stir::PoissonLogLikelihoodWithLinearModelForMeanAndListModeDataWithProjMatrixByBin&lt; TargetT &gt;</a>.</p>

</div>
</div>
<a id="a6d3ad1311f0f0eb8a9f2ec874c133fae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d3ad1311f0f0eb8a9f2ec874c133fae">&#9670;&nbsp;</a></span>post_processing()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TargetT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMean.html">stir::PoissonLogLikelihoodWithLinearModelForMean</a>&lt; TargetT &gt;::post_processing </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This will be called at the end of the parsing. </p>
<dl class="section return"><dt>Returns</dt><dd>false if everything OK, true if not </dd></dl>

<p>Reimplemented from <a class="el" href="classstir_1_1ParsingObject.html#a76911426e945844fe3429191db43af77">stir::ParsingObject</a>.</p>

<p>Reimplemented in <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndProjData.html#a205755a97b0f08cb7d0b57d5ea912eeb">stir::PoissonLogLikelihoodWithLinearModelForMeanAndProjData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion.html#a02905d4c6441c11fc3e54bc8696ead31">stir::PoissonLogLikelihoodWithLinearModelForMeanAndGatedProjDataWithMotion&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearKineticModelAndDynamicProjectionData.html#a6b8c6d8b7199f2a83c169f172fc533f3">stir::PoissonLogLikelihoodWithLinearKineticModelAndDynamicProjectionData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndDynamicProjData.html#af2966783dad33ce5b489d66a8bc5b3b5">stir::PoissonLogLikelihoodWithLinearModelForMeanAndDynamicProjData&lt; TargetT &gt;</a>, <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeData.html#a458465ea6382263a6a63f13c05e13487">stir::PoissonLogLikelihoodWithLinearModelForMeanAndListModeData&lt; TargetT &gt;</a>, and <a class="el" href="classstir_1_1PoissonLogLikelihoodWithLinearModelForMeanAndListModeDataWithProjMatrixByBin.html#aadb38d4d00cbe15d0550f568562bcb6f">stir::PoissonLogLikelihoodWithLinearModelForMeanAndListModeDataWithProjMatrixByBin&lt; TargetT &gt;</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/sirfuser/devel/STIRdistrib/STIR/src/include/stir/KOSMAPOSL/<a class="el" href="KOSMAPOSLReconstruction_8h_source.html">KOSMAPOSLReconstruction.h</a></li>
<li>/home/sirfuser/devel/STIRdistrib/STIR/src/include/stir/recon_buildblock/<a class="el" href="PoissonLogLikelihoodWithLinearModelForMean_8h_source.html">PoissonLogLikelihoodWithLinearModelForMean.h</a></li>
<li>/home/sirfuser/devel/STIRdistrib/STIR/src/recon_buildblock/<a class="el" href="PoissonLogLikelihoodWithLinearModelForMean_8cxx.html">PoissonLogLikelihoodWithLinearModelForMean.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 2 2021 10:00:39 for STIR by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
