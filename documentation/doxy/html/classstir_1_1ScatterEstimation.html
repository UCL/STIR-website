<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STIR: stir::ScatterEstimation Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STIR
   &#160;<span id="projectnumber">5.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacestir.html">stir</a></li><li class="navelem"><a class="el" href="classstir_1_1ScatterEstimation.html">ScatterEstimation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classstir_1_1ScatterEstimation-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">stir::ScatterEstimation Class Reference<div class="ingroups"><a class="el" href="group__STIR.html">STIR</a> &raquo; <a class="el" href="group__STIR__library.html">STIR library</a> &raquo; <a class="el" href="group__scatter.html">Scatter estimation building blocks</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Estimate the scatter probability using a model-based approach.  
 <a href="classstir_1_1ScatterEstimation.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="ScatterEstimation_8h_source.html">stir/scatter/ScatterEstimation.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for stir::ScatterEstimation:</div>
<div class="dyncontent">
<div class="center"><img src="classstir_1_1ScatterEstimation__inherit__graph.png" border="0" usemap="#stir_1_1ScatterEstimation_inherit__map" alt="Inheritance graph"/></div>
<map name="stir_1_1ScatterEstimation_inherit__map" id="stir_1_1ScatterEstimation_inherit__map">
<area shape="rect" id="node2" href="classstir_1_1ParsingObject.html" title="A base class for objects that want to be able to parse parameter files. " alt="" coords="19,5,159,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a76f5945ab5c560fabd2bdf2af86a44fd"><td class="memItemLeft" align="right" valign="top"><a id="a76f5945ab5c560fabd2bdf2af86a44fd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a76f5945ab5c560fabd2bdf2af86a44fd">ScatterEstimation</a> ()</td></tr>
<tr class="memdesc:a76f5945ab5c560fabd2bdf2af86a44fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor (calls <a class="el" href="classstir_1_1ScatterEstimation.html#a2fed1d09541ce5d92916c08993856318" title="All recomputes_** will default true. ">set_defaults()</a>) <br /></td></tr>
<tr class="separator:a76f5945ab5c560fabd2bdf2af86a44fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3b3365671daaf1de03d06c2259017b"><td class="memItemLeft" align="right" valign="top"><a id="a7b3b3365671daaf1de03d06c2259017b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a7b3b3365671daaf1de03d06c2259017b">ScatterEstimation</a> (const std::string &amp;parameter_filename)</td></tr>
<tr class="memdesc:a7b3b3365671daaf1de03d06c2259017b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overloaded constructor with parameter file and initialisation. <br /></td></tr>
<tr class="separator:a7b3b3365671daaf1de03d06c2259017b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20adf5073f27f5c112203fa1aef4cfc8"><td class="memItemLeft" align="right" valign="top"><a id="a20adf5073f27f5c112203fa1aef4cfc8"></a>
virtual <a class="el" href="classstir_1_1Succeeded.html">Succeeded</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a20adf5073f27f5c112203fa1aef4cfc8">process_data</a> ()</td></tr>
<tr class="memdesc:a20adf5073f27f5c112203fa1aef4cfc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Full process_data which performs <a class="el" href="classstir_1_1ScatterEstimation.html#a3ba6aebef60bff5fd4cf4850537e68cf" title="set_up ">set_up()</a> before beginning. <br /></td></tr>
<tr class="separator:a20adf5073f27f5c112203fa1aef4cfc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eb1ef7f405e76fef285bd55dc5f9ee2"><td class="memItemLeft" align="right" valign="top"><a id="a9eb1ef7f405e76fef285bd55dc5f9ee2"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a9eb1ef7f405e76fef285bd55dc5f9ee2">get_output</a> () const</td></tr>
<tr class="memdesc:a9eb1ef7f405e76fef285bd55dc5f9ee2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current scatter estimate. <br /></td></tr>
<tr class="separator:a9eb1ef7f405e76fef285bd55dc5f9ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ba6aebef60bff5fd4cf4850537e68cf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classstir_1_1Succeeded.html">Succeeded</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a3ba6aebef60bff5fd4cf4850537e68cf">set_up</a> ()</td></tr>
<tr class="memdesc:a3ba6aebef60bff5fd4cf4850537e68cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">set_up  <a href="#a3ba6aebef60bff5fd4cf4850537e68cf">More...</a><br /></td></tr>
<tr class="separator:a3ba6aebef60bff5fd4cf4850537e68cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a207441b869453637a816c56ce94952a2"><td class="memItemLeft" align="right" valign="top"><a id="a207441b869453637a816c56ce94952a2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a207441b869453637a816c56ce94952a2">set_input_proj_data_sptr</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;)</td></tr>
<tr class="memdesc:a207441b869453637a816c56ce94952a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the input projdata. <br /></td></tr>
<tr class="separator:a207441b869453637a816c56ce94952a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a040c8f5cbcb180997de1e0f5c8da5530"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a040c8f5cbcb180997de1e0f5c8da5530">set_input_data</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt; &amp;data)</td></tr>
<tr class="memdesc:a040c8f5cbcb180997de1e0f5c8da5530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the input projdata.  <a href="#a040c8f5cbcb180997de1e0f5c8da5530">More...</a><br /></td></tr>
<tr class="separator:a040c8f5cbcb180997de1e0f5c8da5530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a721fcfd13c08ae91fa0ea03b820a462c"><td class="memItemLeft" align="right" valign="top"><a id="a721fcfd13c08ae91fa0ea03b820a462c"></a>
shared_ptr&lt; const <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_input_data</b> () const</td></tr>
<tr class="separator:a721fcfd13c08ae91fa0ea03b820a462c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade55606f77ff3a309965ed8b36308d04"><td class="memItemLeft" align="right" valign="top"><a id="ade55606f77ff3a309965ed8b36308d04"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#ade55606f77ff3a309965ed8b36308d04">set_reconstruction_method_sptr</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1Reconstruction.html">Reconstruction</a>&lt; <a class="el" href="classstir_1_1DiscretisedDensity.html">DiscretisedDensity</a>&lt; 3, float &gt; &gt; &gt;)</td></tr>
<tr class="memdesc:ade55606f77ff3a309965ed8b36308d04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the reconstruction method for the scatter estimation. <br /></td></tr>
<tr class="separator:ade55606f77ff3a309965ed8b36308d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab74550def0f80fd2190b344071046c27"><td class="memItemLeft" align="right" valign="top"><a id="ab74550def0f80fd2190b344071046c27"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#ab74550def0f80fd2190b344071046c27">set_attenuation_image_sptr</a> (const shared_ptr&lt; const <a class="el" href="classstir_1_1DiscretisedDensity.html">DiscretisedDensity</a>&lt; 3, float &gt; &gt;)</td></tr>
<tr class="memdesc:ab74550def0f80fd2190b344071046c27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the full resolution attenuation image. <br /></td></tr>
<tr class="separator:ab74550def0f80fd2190b344071046c27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bc45dab478fe65fc54695ba8db201f5"><td class="memItemLeft" align="right" valign="top"><a id="a5bc45dab478fe65fc54695ba8db201f5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a5bc45dab478fe65fc54695ba8db201f5">set_attenuation_correction_proj_data_sptr</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;)</td></tr>
<tr class="memdesc:a5bc45dab478fe65fc54695ba8db201f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">set projection data that contains the attenuation correction factors <br /></td></tr>
<tr class="separator:a5bc45dab478fe65fc54695ba8db201f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ae73163383cdfcd436de88a08d5073"><td class="memItemLeft" align="right" valign="top"><a id="ab0ae73163383cdfcd436de88a08d5073"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#ab0ae73163383cdfcd436de88a08d5073">set_normalisation_sptr</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1BinNormalisation.html">BinNormalisation</a> &gt;)</td></tr>
<tr class="memdesc:ab0ae73163383cdfcd436de88a08d5073"><td class="mdescLeft">&#160;</td><td class="mdescRight">set normalisation object (excluding attenuation) <br /></td></tr>
<tr class="separator:ab0ae73163383cdfcd436de88a08d5073"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a014a317061f6cb500b3c773c7a805c"><td class="memItemLeft" align="right" valign="top"><a id="a8a014a317061f6cb500b3c773c7a805c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_background_proj_data_sptr</b> (const shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;)</td></tr>
<tr class="separator:a8a014a317061f6cb500b3c773c7a805c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbc3eec4f68bc1b28e75de60195a1d49"><td class="memItemLeft" align="right" valign="top"><a id="adbc3eec4f68bc1b28e75de60195a1d49"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_initial_activity_image_sptr</b> (const shared_ptr&lt; const <a class="el" href="classstir_1_1DiscretisedDensity.html">DiscretisedDensity</a>&lt; 3, float &gt; &gt;)</td></tr>
<tr class="separator:adbc3eec4f68bc1b28e75de60195a1d49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25335ad270fd6b481674e1094f7ac830"><td class="memItemLeft" align="right" valign="top"><a id="a25335ad270fd6b481674e1094f7ac830"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_mask_image_sptr</b> (const shared_ptr&lt; const <a class="el" href="classstir_1_1DiscretisedDensity.html">DiscretisedDensity</a>&lt; 3, float &gt; &gt;)</td></tr>
<tr class="separator:a25335ad270fd6b481674e1094f7ac830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a789d689bc3f266b275d1cd214837ea47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a789d689bc3f266b275d1cd214837ea47">set_mask_proj_data_sptr</a> (const shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt; arg)</td></tr>
<tr class="memdesc:a789d689bc3f266b275d1cd214837ea47"><td class="mdescLeft">&#160;</td><td class="mdescRight">set mask for tail-fitting  <a href="#a789d689bc3f266b275d1cd214837ea47">More...</a><br /></td></tr>
<tr class="separator:a789d689bc3f266b275d1cd214837ea47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addcc716934a0d0d0f04a35332e968a42"><td class="memItemLeft" align="right" valign="top"><a id="addcc716934a0d0d0f04a35332e968a42"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_scatter_simulation_method_sptr</b> (const shared_ptr&lt; <a class="el" href="classstir_1_1ScatterSimulation.html">ScatterSimulation</a> &gt;)</td></tr>
<tr class="separator:addcc716934a0d0d0f04a35332e968a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6230a52c23fa34f530146fe2c924e03"><td class="memItemLeft" align="right" valign="top"><a id="ab6230a52c23fa34f530146fe2c924e03"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_num_iterations</b> (int)</td></tr>
<tr class="separator:ab6230a52c23fa34f530146fe2c924e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdaae7ea8fb41e11b60078dec74564ec"><td class="memItemLeft" align="right" valign="top"><a id="acdaae7ea8fb41e11b60078dec74564ec"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_output_scatter_estimate_prefix</b> (const std::string &amp;)</td></tr>
<tr class="separator:acdaae7ea8fb41e11b60078dec74564ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930e6a5675d4907a358653c287bcf97d"><td class="memItemLeft" align="right" valign="top"><a id="a930e6a5675d4907a358653c287bcf97d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_export_scatter_estimates_of_each_iteration</b> (bool)</td></tr>
<tr class="separator:a930e6a5675d4907a358653c287bcf97d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c7a135c3fab34ac5e96c4ac9fb6f5d0"><td class="memItemLeft" align="right" valign="top"><a id="a1c7a135c3fab34ac5e96c4ac9fb6f5d0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_max_scale_value</b> (float value)</td></tr>
<tr class="separator:a1c7a135c3fab34ac5e96c4ac9fb6f5d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4806c08ae495cafeeaf54e269d9b064f"><td class="memItemLeft" align="right" valign="top"><a id="a4806c08ae495cafeeaf54e269d9b064f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_min_scale_value</b> (float value)</td></tr>
<tr class="separator:a4806c08ae495cafeeaf54e269d9b064f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e62440fffb5a3b17811738417f54cd0"><td class="memItemLeft" align="right" valign="top"><a id="a7e62440fffb5a3b17811738417f54cd0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_mask_projdata_filename</b> (std::string name)</td></tr>
<tr class="separator:a7e62440fffb5a3b17811738417f54cd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17680567d110df425dfeca0af9d6d493"><td class="memItemLeft" align="right" valign="top"><a id="a17680567d110df425dfeca0af9d6d493"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_mask_image_filename</b> (std::string name)</td></tr>
<tr class="separator:a17680567d110df425dfeca0af9d6d493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba891b9e74130ddf307092a17f612c01"><td class="memItemLeft" align="right" valign="top"><a id="aba891b9e74130ddf307092a17f612c01"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_output_additive_estimate_prefix</b> (std::string name)</td></tr>
<tr class="separator:aba891b9e74130ddf307092a17f612c01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fc6a49f2a0a630493a050a536c9504d"><td class="memItemLeft" align="right" valign="top"><a id="a6fc6a49f2a0a630493a050a536c9504d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_run_debug_mode</b> (bool debug)</td></tr>
<tr class="separator:a6fc6a49f2a0a630493a050a536c9504d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dfdaa6087a99699346f9ebf77c41d9a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a6dfdaa6087a99699346f9ebf77c41d9a">get_iterations_num</a> () const</td></tr>
<tr class="memdesc:a6dfdaa6087a99699346f9ebf77c41d9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the zoom factor in the XY plane for the downsampling of the activity and attenuation image.  <a href="#a6dfdaa6087a99699346f9ebf77c41d9a">More...</a><br /></td></tr>
<tr class="separator:a6dfdaa6087a99699346f9ebf77c41d9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f3eb555800e60b9a2d84a6fdea3dd7"><td class="memItemLeft" align="right" valign="top"><a id="a48f3eb555800e60b9a2d84a6fdea3dd7"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a48f3eb555800e60b9a2d84a6fdea3dd7">get_num_iterations</a> () const</td></tr>
<tr class="memdesc:a48f3eb555800e60b9a2d84a6fdea3dd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of iterations for the scatter estimation. <br /></td></tr>
<tr class="separator:a48f3eb555800e60b9a2d84a6fdea3dd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107504be28ea985d9e051691f6761d1d"><td class="memItemLeft" align="right" valign="top"><a id="a107504be28ea985d9e051691f6761d1d"></a>
shared_ptr&lt; const <a class="el" href="classstir_1_1DiscretisedDensity.html">DiscretisedDensity</a>&lt; 3, float &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a107504be28ea985d9e051691f6761d1d">get_estimated_activity_image_sptr</a> () const</td></tr>
<tr class="memdesc:a107504be28ea985d9e051691f6761d1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the (low resolution) estimate of the activity image. <br /></td></tr>
<tr class="separator:a107504be28ea985d9e051691f6761d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca0db5d394151dfa1dcb81be82803e2"><td class="memItemLeft" align="right" valign="top"><a id="aaca0db5d394151dfa1dcb81be82803e2"></a>
virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#aaca0db5d394151dfa1dcb81be82803e2">already_setup</a> () const</td></tr>
<tr class="memdesc:aaca0db5d394151dfa1dcb81be82803e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">allows checking if we have called <a class="el" href="classstir_1_1ScatterEstimation.html#a3ba6aebef60bff5fd4cf4850537e68cf" title="set_up ">set_up()</a> <br /></td></tr>
<tr class="separator:aaca0db5d394151dfa1dcb81be82803e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classstir_1_1ParsingObject"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classstir_1_1ParsingObject')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classstir_1_1ParsingObject.html">stir::ParsingObject</a></td></tr>
<tr class="memitem:a15b8a585ba2b09674b823446bf8481bf inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="a15b8a585ba2b09674b823446bf8481bf"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ParsingObject</b> (const <a class="el" href="classstir_1_1ParsingObject.html">ParsingObject</a> &amp;)</td></tr>
<tr class="separator:a15b8a585ba2b09674b823446bf8481bf inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20920a86db3428de6fd40381ef50aba4 inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="a20920a86db3428de6fd40381ef50aba4"></a>
<a class="el" href="classstir_1_1ParsingObject.html">ParsingObject</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classstir_1_1ParsingObject.html">ParsingObject</a> &amp;)</td></tr>
<tr class="separator:a20920a86db3428de6fd40381ef50aba4 inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a268a7806a6ad7c78ec43f21582627163 inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="a268a7806a6ad7c78ec43f21582627163"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ask_parameters</b> ()</td></tr>
<tr class="separator:a268a7806a6ad7c78ec43f21582627163 inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf7dc9a4725e6e6673b5cf36f8433a0b inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="acf7dc9a4725e6e6673b5cf36f8433a0b"></a>
virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><b>parameter_info</b> ()</td></tr>
<tr class="separator:acf7dc9a4725e6e6673b5cf36f8433a0b inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8597c63ee9c4e5c927117daf35f2b129 inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="a8597c63ee9c4e5c927117daf35f2b129"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>parse</b> (std::istream &amp;f)</td></tr>
<tr class="separator:a8597c63ee9c4e5c927117daf35f2b129 inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedc5f10739c1dfb78fecd33c74d7d643 inherit pub_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="aedc5f10739c1dfb78fecd33c74d7d643"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>parse</b> (const char *const filename)</td></tr>
<tr class="separator:aedc5f10739c1dfb78fecd33c74d7d643 inherit pub_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ace6b465e634d39ff125681d5b384d1bd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#ace6b465e634d39ff125681d5b384d1bd">upsample_and_fit_scatter_estimate</a> (<a class="el" href="classstir_1_1ProjData.html">ProjData</a> &amp;scaled_scatter_proj_data, const <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &amp;emission_proj_data, const <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &amp;scatter_proj_data, <a class="el" href="classstir_1_1BinNormalisation.html">BinNormalisation</a> &amp;scatter_normalisation, const <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &amp;weights_proj_data, const float min_scale_factor, const float max_scale_factor, const unsigned half_filter_width, <a class="el" href="group__BSpline.html#gaa4a83dae28c1550670e3fc9482fb2fe1">BSpline::BSplineType</a> spline_type, const bool remove_interleaving=true)</td></tr>
<tr class="memdesc:ace6b465e634d39ff125681d5b384d1bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">upsample coarse scatter estimate and fit it to tails of the emission data  <a href="#ace6b465e634d39ff125681d5b384d1bd">More...</a><br /></td></tr>
<tr class="separator:ace6b465e634d39ff125681d5b384d1bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a2fed1d09541ce5d92916c08993856318"><td class="memItemLeft" align="right" valign="top"><a id="a2fed1d09541ce5d92916c08993856318"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a2fed1d09541ce5d92916c08993856318">set_defaults</a> ()</td></tr>
<tr class="memdesc:a2fed1d09541ce5d92916c08993856318"><td class="mdescLeft">&#160;</td><td class="mdescRight">All recomputes_** will default true. <br /></td></tr>
<tr class="separator:a2fed1d09541ce5d92916c08993856318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4a883113f5f2ee32f74cbb9a5067d88"><td class="memItemLeft" align="right" valign="top"><a id="af4a883113f5f2ee32f74cbb9a5067d88"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#af4a883113f5f2ee32f74cbb9a5067d88">initialise_keymap</a> ()</td></tr>
<tr class="memdesc:af4a883113f5f2ee32f74cbb9a5067d88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise all keywords. <br /></td></tr>
<tr class="separator:af4a883113f5f2ee32f74cbb9a5067d88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceaf7c9893842d246996d16c0b03f8a0"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#aceaf7c9893842d246996d16c0b03f8a0">post_processing</a> ()</td></tr>
<tr class="memdesc:aceaf7c9893842d246996d16c0b03f8a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This will be called at the end of the parsing.  <a href="#aceaf7c9893842d246996d16c0b03f8a0">More...</a><br /></td></tr>
<tr class="separator:aceaf7c9893842d246996d16c0b03f8a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classstir_1_1ParsingObject"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classstir_1_1ParsingObject')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classstir_1_1ParsingObject.html">stir::ParsingObject</a></td></tr>
<tr class="memitem:ad8e81786834c010c96c31bce2bac3f6d inherit pro_methods_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ParsingObject.html#ad8e81786834c010c96c31bce2bac3f6d">set_key_values</a> ()</td></tr>
<tr class="memdesc:ad8e81786834c010c96c31bce2bac3f6d inherit pro_methods_classstir_1_1ParsingObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">This will be called before parsing or parameter_info is called.  <a href="classstir_1_1ParsingObject.html#ad8e81786834c010c96c31bce2bac3f6d">More...</a><br /></td></tr>
<tr class="separator:ad8e81786834c010c96c31bce2bac3f6d inherit pro_methods_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a2888fb4f785b5b2b7879164d9c035f20"><td class="memItemLeft" align="right" valign="top"><a id="a2888fb4f785b5b2b7879164d9c035f20"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a2888fb4f785b5b2b7879164d9c035f20">recompute_mask_image</a></td></tr>
<tr class="memdesc:a2888fb4f785b5b2b7879164d9c035f20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recompute or load the mask image. <br /></td></tr>
<tr class="separator:a2888fb4f785b5b2b7879164d9c035f20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad39840831f0c7a1089c3a19a7899ced8"><td class="memItemLeft" align="right" valign="top"><a id="ad39840831f0c7a1089c3a19a7899ced8"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#ad39840831f0c7a1089c3a19a7899ced8">recompute_mask_projdata</a></td></tr>
<tr class="memdesc:ad39840831f0c7a1089c3a19a7899ced8"><td class="mdescLeft">&#160;</td><td class="mdescRight">If set the mask projdata will be recomputed. <br /></td></tr>
<tr class="separator:ad39840831f0c7a1089c3a19a7899ced8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb3583b0b4ee2bebc4d7802ad5f2bfd8"><td class="memItemLeft" align="right" valign="top"><a id="adb3583b0b4ee2bebc4d7802ad5f2bfd8"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#adb3583b0b4ee2bebc4d7802ad5f2bfd8">recompute_atten_projdata</a></td></tr>
<tr class="memdesc:adb3583b0b4ee2bebc4d7802ad5f2bfd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">If set to 1 the attenuation coefficients are going to be recalculated. <br /></td></tr>
<tr class="separator:adb3583b0b4ee2bebc4d7802ad5f2bfd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22bde20f9710c8acdbf864db610ca6db"><td class="memItemLeft" align="right" valign="top"><a id="a22bde20f9710c8acdbf864db610ca6db"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1Reconstruction.html">Reconstruction</a>&lt; <a class="el" href="classstir_1_1DiscretisedDensity.html">DiscretisedDensity</a>&lt; 3, float &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a22bde20f9710c8acdbf864db610ca6db">reconstruction_template_sptr</a></td></tr>
<tr class="memdesc:a22bde20f9710c8acdbf864db610ca6db"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the reconstruction object which is going to be used for the scatter estimation and the calculation of the initial activity image (if recompute set). It can be defined in the same parameters file as the scatter parameters or in an external defined in the reconstruction_template_par_filename. <br /></td></tr>
<tr class="separator:a22bde20f9710c8acdbf864db610ca6db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa520b2ea2d293ad480b25089293f06e0"><td class="memItemLeft" align="right" valign="top"><a id="aa520b2ea2d293ad480b25089293f06e0"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1DiscretisedDensity.html">DiscretisedDensity</a>&lt; 3, float &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#aa520b2ea2d293ad480b25089293f06e0">current_activity_image_sptr</a></td></tr>
<tr class="memdesc:aa520b2ea2d293ad480b25089293f06e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current activity estimate. <br /></td></tr>
<tr class="separator:aa520b2ea2d293ad480b25089293f06e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae64ddcfe58e581557a0f795de33e16f3"><td class="memItemLeft" align="right" valign="top"><a id="ae64ddcfe58e581557a0f795de33e16f3"></a>
shared_ptr&lt; const <a class="el" href="classstir_1_1DiscretisedDensity.html">DiscretisedDensity</a>&lt; 3, float &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#ae64ddcfe58e581557a0f795de33e16f3">atten_image_sptr</a></td></tr>
<tr class="memdesc:ae64ddcfe58e581557a0f795de33e16f3"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classImage.html" title="Reading and writing gipl files. ">Image</a> with attenuation values. <br /></td></tr>
<tr class="separator:ae64ddcfe58e581557a0f795de33e16f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6215678213614bb082e55776072fe27d"><td class="memItemLeft" align="right" valign="top"><a id="a6215678213614bb082e55776072fe27d"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1BinNormalisation.html">BinNormalisation</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a6215678213614bb082e55776072fe27d">norm_3d_sptr</a></td></tr>
<tr class="memdesc:a6215678213614bb082e55776072fe27d"><td class="mdescLeft">&#160;</td><td class="mdescRight">normalisation components in 3D (without atten) <br /></td></tr>
<tr class="separator:a6215678213614bb082e55776072fe27d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d823b413eb93823fda273a0d9c72a20"><td class="memItemLeft" align="right" valign="top"><a id="a3d823b413eb93823fda273a0d9c72a20"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a3d823b413eb93823fda273a0d9c72a20">mask_projdata_sptr</a></td></tr>
<tr class="memdesc:a3d823b413eb93823fda273a0d9c72a20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask proj_data. <br /></td></tr>
<tr class="separator:a3d823b413eb93823fda273a0d9c72a20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc605a15c52ab41915aeb36fbf5bea6"><td class="memItemLeft" align="right" valign="top"><a id="acdc605a15c52ab41915aeb36fbf5bea6"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#acdc605a15c52ab41915aeb36fbf5bea6">input_projdata_sptr</a></td></tr>
<tr class="memdesc:acdc605a15c52ab41915aeb36fbf5bea6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The full 3D projdata are used for the calculation of the 2D and later for the upsampling back to 3D. <br /></td></tr>
<tr class="separator:acdc605a15c52ab41915aeb36fbf5bea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a852e6094644e95dc0d1d94eeaebda1a0"><td class="memItemLeft" align="right" valign="top"><a id="a852e6094644e95dc0d1d94eeaebda1a0"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a852e6094644e95dc0d1d94eeaebda1a0">input_projdata_2d_sptr</a></td></tr>
<tr class="memdesc:a852e6094644e95dc0d1d94eeaebda1a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The 2D projdata are used for the scatter estimation. <br /></td></tr>
<tr class="separator:a852e6094644e95dc0d1d94eeaebda1a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e6854912d678eb3da7d4805257e5d7c"><td class="memItemLeft" align="right" valign="top"><a id="a2e6854912d678eb3da7d4805257e5d7c"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a2e6854912d678eb3da7d4805257e5d7c">add_projdata_2d_sptr</a></td></tr>
<tr class="memdesc:a2e6854912d678eb3da7d4805257e5d7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Additive projection data after SSRB &ndash; Randoms. <br /></td></tr>
<tr class="separator:a2e6854912d678eb3da7d4805257e5d7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d120468f7744719fad60b79eace6b63"><td class="memItemLeft" align="right" valign="top"><a id="a2d120468f7744719fad60b79eace6b63"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a2d120468f7744719fad60b79eace6b63">data_to_fit_projdata_sptr</a></td></tr>
<tr class="memdesc:a2d120468f7744719fad60b79eace6b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prompts - randoms. <br /></td></tr>
<tr class="separator:a2d120468f7744719fad60b79eace6b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88652cf235517aeba33914e80b3a7f59"><td class="memItemLeft" align="right" valign="top"><a id="a88652cf235517aeba33914e80b3a7f59"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>add_projdata_sptr</b></td></tr>
<tr class="separator:a88652cf235517aeba33914e80b3a7f59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8430e98802dbd1bcf84c4ac839a45df"><td class="memItemLeft" align="right" valign="top"><a id="ac8430e98802dbd1bcf84c4ac839a45df"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#ac8430e98802dbd1bcf84c4ac839a45df">back_projdata_2d_sptr</a></td></tr>
<tr class="memdesc:ac8430e98802dbd1bcf84c4ac839a45df"><td class="mdescLeft">&#160;</td><td class="mdescRight">(Additive + Scatter Estimate) * Mult in 2D <br /></td></tr>
<tr class="separator:ac8430e98802dbd1bcf84c4ac839a45df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7362e2fbc1285190f20eaa8630d5fb9e"><td class="memItemLeft" align="right" valign="top"><a id="a7362e2fbc1285190f20eaa8630d5fb9e"></a>
shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a7362e2fbc1285190f20eaa8630d5fb9e">back_projdata_sptr</a></td></tr>
<tr class="memdesc:a7362e2fbc1285190f20eaa8630d5fb9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initially this points to the un-normalised randoms. <br /></td></tr>
<tr class="separator:a7362e2fbc1285190f20eaa8630d5fb9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbcc957a4321d7c3840f9485d372aa1a"><td class="memItemLeft" align="right" valign="top"><a id="acbcc957a4321d7c3840f9485d372aa1a"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#acbcc957a4321d7c3840f9485d372aa1a">mask_image_filename</a></td></tr>
<tr class="memdesc:acbcc957a4321d7c3840f9485d372aa1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filename of mask image. <br /></td></tr>
<tr class="separator:acbcc957a4321d7c3840f9485d372aa1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab03f8924b921f10fa4909fe4b350b836"><td class="memItemLeft" align="right" valign="top"><a id="ab03f8924b921f10fa4909fe4b350b836"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#ab03f8924b921f10fa4909fe4b350b836">mask_projdata_filename</a></td></tr>
<tr class="memdesc:ab03f8924b921f10fa4909fe4b350b836"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filename of mask's projdata. <br /></td></tr>
<tr class="separator:ab03f8924b921f10fa4909fe4b350b836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba532c89260e3c4485a34538dfa5598b"><td class="memItemLeft" align="right" valign="top"><a id="aba532c89260e3c4485a34538dfa5598b"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#aba532c89260e3c4485a34538dfa5598b">back_projdata_filename</a></td></tr>
<tr class="memdesc:aba532c89260e3c4485a34538dfa5598b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filename of background projdata. <br /></td></tr>
<tr class="separator:aba532c89260e3c4485a34538dfa5598b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3ff1d6214ec59be4294a66b6cc106c8"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#ad3ff1d6214ec59be4294a66b6cc106c8">tail_mask_par_filename</a></td></tr>
<tr class="memdesc:ad3ff1d6214ec59be4294a66b6cc106c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optional parameter file for the tail fitting.  <a href="#ad3ff1d6214ec59be4294a66b6cc106c8">More...</a><br /></td></tr>
<tr class="separator:ad3ff1d6214ec59be4294a66b6cc106c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5307cc76151c003ff790758bcd8d2055"><td class="memItemLeft" align="right" valign="top"><a id="a5307cc76151c003ff790758bcd8d2055"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a5307cc76151c003ff790758bcd8d2055">input_projdata_filename</a></td></tr>
<tr class="memdesc:a5307cc76151c003ff790758bcd8d2055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filename of the measured emission 3D data. <br /></td></tr>
<tr class="separator:a5307cc76151c003ff790758bcd8d2055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadbf3bda61be8c705662b13084842c35"><td class="memItemLeft" align="right" valign="top"><a id="aadbf3bda61be8c705662b13084842c35"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#aadbf3bda61be8c705662b13084842c35">atten_image_filename</a></td></tr>
<tr class="memdesc:aadbf3bda61be8c705662b13084842c35"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the image file name with the anatomic information. <br /></td></tr>
<tr class="separator:aadbf3bda61be8c705662b13084842c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a1773cecc8122d6802aa3f35ad7ce26"><td class="memItemLeft" align="right" valign="top"><a id="a1a1773cecc8122d6802aa3f35ad7ce26"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a1a1773cecc8122d6802aa3f35ad7ce26">recon_template_par_filename</a></td></tr>
<tr class="memdesc:a1a1773cecc8122d6802aa3f35ad7ce26"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename for the parameters file of the reconstruction method. <br /></td></tr>
<tr class="separator:a1a1773cecc8122d6802aa3f35ad7ce26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6040476b88557cd0aa6a2cca6cf70b78"><td class="memItemLeft" align="right" valign="top"><a id="a6040476b88557cd0aa6a2cca6cf70b78"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a6040476b88557cd0aa6a2cca6cf70b78">atten_coeff_filename</a></td></tr>
<tr class="memdesc:a6040476b88557cd0aa6a2cca6cf70b78"><td class="mdescLeft">&#160;</td><td class="mdescRight">The file name for the attenuation coefficients. If they are to be recalculated they will be stored here, if set. <br /></td></tr>
<tr class="separator:a6040476b88557cd0aa6a2cca6cf70b78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a051d5cee13b9001396bedc45b743e0c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structstir_1_1MaskingParameters.html">MaskingParameters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a051d5cee13b9001396bedc45b743e0c3">masking_parameters</a></td></tr>
<tr class="separator:a051d5cee13b9001396bedc45b743e0c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb252446bc6db862fdc6c193d73deec0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#acb252446bc6db862fdc6c193d73deec0">num_scatter_iterations</a></td></tr>
<tr class="separator:acb252446bc6db862fdc6c193d73deec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a718244af847584c4d7229ebcdac1f233"><td class="memItemLeft" align="right" valign="top"><a id="a718244af847584c4d7229ebcdac1f233"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstir_1_1ScatterEstimation.html#a718244af847584c4d7229ebcdac1f233">output_scatter_estimate_prefix</a></td></tr>
<tr class="memdesc:a718244af847584c4d7229ebcdac1f233"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output file name prefix. <br /></td></tr>
<tr class="separator:a718244af847584c4d7229ebcdac1f233"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34e8b9a499195966baca1ab3d3956d9a"><td class="memItemLeft" align="right" valign="top"><a id="a34e8b9a499195966baca1ab3d3956d9a"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>output_additive_estimate_prefix</b></td></tr>
<tr class="separator:a34e8b9a499195966baca1ab3d3956d9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classstir_1_1ParsingObject"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classstir_1_1ParsingObject')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classstir_1_1ParsingObject.html">stir::ParsingObject</a></td></tr>
<tr class="memitem:ac53aef0f7ecd5dbb6204239b14e657f8 inherit pro_attribs_classstir_1_1ParsingObject"><td class="memItemLeft" align="right" valign="top"><a id="ac53aef0f7ecd5dbb6204239b14e657f8"></a>
<a class="el" href="classstir_1_1KeyParser.html">KeyParser</a>&#160;</td><td class="memItemRight" valign="bottom"><b>parser</b></td></tr>
<tr class="separator:ac53aef0f7ecd5dbb6204239b14e657f8 inherit pro_attribs_classstir_1_1ParsingObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Estimate the scatter probability using a model-based approach. </p>
<dl class="section author"><dt>Author</dt><dd>Nikos Efthimiou </dd>
<dd>
Kris Thielemans</dd></dl>
<p>This is an implementation of Watson's SSS iterative algorithm to estimate scatter. Simulation is normally at low resolution, ideally reconstruction as well (to save time). The code also does tail-fitting.</p>
<p>A particular feature is that the first iterations happen in 2D (after SSRB of all the data). Currently only the last simulation is in 3D. This could be changed later.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000169">Todo:</a></b></dt><dd><p class="startdd">The code should throw an error if 2D input data are loaded. It should just deactivate the final upsampling. </p>
<p>Currently FBP reconstruction is not working and just throws an error. </p>
<p class="enddd">This code needs far more documentation.</p>
</dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000024">Deprecated:</a></b></dt><dd>The current parsing code still allows the <code>bin normalisation type</code> keyword to specify a "chained" normalisation object with first the norm and second the atten. As there is no way to guarantee that this will be the case, we have now replaced this with explicit setting of the norm factors only (keyword <code>normalisation type</code>) and the attenuation factors. The naming of the keywords is confusing however. (Ensuring backwards compatibility was not so easy, so the code might look confusing.) </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ace6b465e634d39ff125681d5b384d1bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace6b465e634d39ff125681d5b384d1bd">&#9670;&nbsp;</a></span>upsample_and_fit_scatter_estimate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void stir::ScatterEstimation::upsample_and_fit_scatter_estimate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classstir_1_1ProjData.html">ProjData</a> &amp;&#160;</td>
          <td class="paramname"><em>scaled_scatter_proj_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &amp;&#160;</td>
          <td class="paramname"><em>emission_proj_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &amp;&#160;</td>
          <td class="paramname"><em>scatter_proj_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classstir_1_1BinNormalisation.html">BinNormalisation</a> &amp;&#160;</td>
          <td class="paramname"><em>scatter_normalisation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &amp;&#160;</td>
          <td class="paramname"><em>weights_proj_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>min_scale_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>max_scale_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>half_filter_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__BSpline.html#gaa4a83dae28c1550670e3fc9482fb2fe1">BSpline::BSplineType</a>&#160;</td>
          <td class="paramname"><em>spline_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>remove_interleaving</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>upsample coarse scatter estimate and fit it to tails of the emission data </p>
<p>Current procedure:</p><ol type="1">
<li>interpolate segment 0 of <em>scatter_proj_data</em> to size of segment 0 of <em>emission_proj_data</em> </li>
<li>inverseSSRB to create oblique segments</li>
<li>undo normalisation (as measured data is not normalised)</li>
<li>find scale factors with <a class="el" href="group__projdata.html#ga6ca5b8f25160eda3d22c15a7dfa64a5e" title="find scale factors between two different sinograms ">get_scale_factors_per_sinogram()</a></li>
<li>apply thresholds</li>
<li>filter scale-factors in axial direction (independently for every segment)</li>
<li>apply scale factors using <a class="el" href="group__projdata.html#gaa8e5cdb3af7c92d88e7b1f4252c47a77" title="apply a scale factor for every sinogram ">scale_sinograms()</a> </li>
</ol>

<p class="reference">References <a class="el" href="classstir_1_1VectorWithOffset.html#a147a665c5ab7818c5197fac452bcff9b">stir::VectorWithOffset&lt; T &gt;::begin()</a>, <a class="el" href="classstir_1_1Array.html#a887028a2daad51cd19237dc272651cdc">stir::Array&lt; num_dimensions, elemT &gt;::begin_all()</a>, <a class="el" href="classstir_1_1VectorWithOffset.html#ab5ea6073b3daf75f23f1b545d0b6593f">stir::VectorWithOffset&lt; T &gt;::end()</a>, <a class="el" href="classstir_1_1Array.html#a3674afccb86b90f13ee648c3e6935475">stir::Array&lt; num_dimensions, elemT &gt;::end_all()</a>, <a class="el" href="group__buildblock.html#ga19b3ad285f04d613640a497f868b385f">stir::error()</a>, <a class="el" href="classstir_1_1ProjData.html#a93e155fb1cae1f57eb6e4c02e92ec9b8">stir::ProjData::fill()</a>, <a class="el" href="classstir_1_1Array.html#abd56d694053e27f36d9c4aceed6a3845">stir::Array&lt; num_dimensions, elemT &gt;::fill()</a>, <a class="el" href="classstir_1_1VectorWithOffset.html#ac3cbbc39532fa95ee7121cb251ab43d0">stir::VectorWithOffset&lt; T &gt;::fill()</a>, <a class="el" href="classstir_1_1ExamData.html#ad79c2d7818f982ac85b2e94ceba830c5">stir::ExamData::get_exam_info_sptr()</a>, <a class="el" href="classstir_1_1ProjDataInfo.html#a6f96709c581f8800521ceb9e7bbe3cb0">stir::ProjDataInfo::get_max_axial_pos_num()</a>, <a class="el" href="classstir_1_1ProjDataInfo.html#af84cfb2229160862c25a86e66955e744">stir::ProjDataInfo::get_max_segment_num()</a>, <a class="el" href="classstir_1_1ProjDataInfo.html#a2cde055a364af39ac7a99cc9b283ba1a">stir::ProjDataInfo::get_min_axial_pos_num()</a>, <a class="el" href="classstir_1_1ProjDataInfo.html#a721c0d148c70dcbd4f150a9d2804051f">stir::ProjDataInfo::get_min_segment_num()</a>, <a class="el" href="classstir_1_1ProjData.html#a1ac406cc7051cec1cabd201bd7d860e3">stir::ProjData::get_proj_data_info_sptr()</a>, <a class="el" href="group__projdata.html#ga6ca5b8f25160eda3d22c15a7dfa64a5e">stir::get_scale_factors_per_sinogram()</a>, <a class="el" href="classstir_1_1Array.html#a65d8d70124654379b1bc507829e14b67">stir::Array&lt; num_dimensions, elemT &gt;::grow()</a>, <a class="el" href="group__buildblock.html#ga58339978ae5e7a02db3ba4d82bff5ab6">stir::info()</a>, <a class="el" href="group__projdata.html#ga0cb657b2de00a68eb0b235a89861f477">stir::interpolate_projdata()</a>, <a class="el" href="group__projdata.html#gae32b9bf6161b4465b00537278ce74722">stir::inverse_SSRB()</a>, <a class="el" href="classstir_1_1BinNormalisation.html#aebe407aa214715b152f50222a6a57998">stir::BinNormalisation::is_trivial()</a>, <a class="el" href="classstir_1_1VectorWithOffset.html#aa0d7c80102ef873b5d60c52f3db4348d">stir::VectorWithOffset&lt; T &gt;::resize()</a>, <a class="el" href="group__projdata.html#gaa8e5cdb3af7c92d88e7b1f4252c47a77">stir::scale_sinograms()</a>, <a class="el" href="classstir_1_1BinNormalisation.html#aa03437ee6f211894a9e3275e93e46726">stir::BinNormalisation::set_up()</a>, <a class="el" href="namespacestir.html#a6c602d976b9fa3dc9a2daf6d42a6f660">stir::threshold_lower()</a>, <a class="el" href="namespacestir.html#a1ad7dd3b0556692f95f67a2d6c9112ce">stir::threshold_upper()</a>, and <a class="el" href="classstir_1_1BinNormalisation.html#ac8f4b1217b33a825138e0928d4a447dd">stir::BinNormalisation::undo()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classstir_1_1ScatterEstimation.html#a20adf5073f27f5c112203fa1aef4cfc8">process_data()</a>.</p>

</div>
</div>
<a id="a3ba6aebef60bff5fd4cf4850537e68cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ba6aebef60bff5fd4cf4850537e68cf">&#9670;&nbsp;</a></span>set_up()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstir_1_1Succeeded.html">Succeeded</a> stir::ScatterEstimation::set_up </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set_up </p>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<p>This function will take care most of the initialisation needed: </p><ul>
<li>
Procedure: <ol>
<li>
Check if debug mode and activate all export flags. </li>
<li>
Load the input_projdata_3d_sptr and perform SSRB </li>
<li>
Initialise (partially for the moment) the reconstruction method: </li>
<li>
Load Normalisation data and perform SSRB </li>
<li>
Load the background data (randoms) and do normalisation (to get the additive data) </li>
</ol>
</li>
</ul>

<p class="reference">References <a class="el" href="classstir_1_1ScatterEstimation.html#a2e6854912d678eb3da7d4805257e5d7c">add_projdata_2d_sptr</a>, <a class="el" href="classstir_1_1FilePath.html#a25cecdc0f314d04a5ef40e15ec0014f4">stir::FilePath::append()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#ae64ddcfe58e581557a0f795de33e16f3">atten_image_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#ac8430e98802dbd1bcf84c4ac839a45df">back_projdata_2d_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a7362e2fbc1285190f20eaa8630d5fb9e">back_projdata_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#aa520b2ea2d293ad480b25089293f06e0">current_activity_image_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a2d120468f7744719fad60b79eace6b63">data_to_fit_projdata_sptr</a>, <a class="el" href="group__buildblock.html#ga19b3ad285f04d613640a497f868b385f">stir::error()</a>, <a class="el" href="classstir_1_1FilePath.html#abc5a7535d76132d7391c073d73885deb">stir::FilePath::get_current_working_directory()</a>, <a class="el" href="group__buildblock.html#ga58339978ae5e7a02db3ba4d82bff5ab6">stir::info()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a852e6094644e95dc0d1d94eeaebda1a0">input_projdata_2d_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#acdc605a15c52ab41915aeb36fbf5bea6">input_projdata_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#acbcc957a4321d7c3840f9485d372aa1a">mask_image_filename</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a3d823b413eb93823fda273a0d9c72a20">mask_projdata_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a051d5cee13b9001396bedc45b743e0c3">masking_parameters</a>, <a class="el" href="namespacedistributed.html#aac893dd256bfd22c5bce0f30000fed83">distributed::min_threshold</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a20adf5073f27f5c112203fa1aef4cfc8">process_data()</a>, <a class="el" href="classstir_1_1ProjData.html#abe098fca9d7ee5dc8a8c14ff6666de97">stir::ProjData::read_from_file()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a2888fb4f785b5b2b7879164d9c035f20">recompute_mask_image</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#ad39840831f0c7a1089c3a19a7899ced8">recompute_mask_projdata</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a22bde20f9710c8acdbf864db610ca6db">reconstruction_template_sptr</a>, <a class="el" href="group__projdata.html#gac58540d3d092496da3c2c10836a6a77f">stir::SSRB()</a>, <a class="el" href="group__buildblock.html#ga45e27d9de6cdc69c146e791a825a20da">stir::warning()</a>, and <a class="el" href="group__IO.html#ga0ad946998d5f86bcb7e829271c8cf517">stir::write_to_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classstir_1_1ScatterEstimation.html#aaca0db5d394151dfa1dcb81be82803e2">already_setup()</a>.</p>

</div>
</div>
<a id="a040c8f5cbcb180997de1e0f5c8da5530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a040c8f5cbcb180997de1e0f5c8da5530">&#9670;&nbsp;</a></span>set_input_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stir::ScatterEstimation::set_input_data </td>
          <td>(</td>
          <td class="paramtype">const shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the input projdata. </p>
<p>Using same name as <a class="el" href="classstir_1_1Reconstruction.html" title="base class for all ReconstructionsAs there is not a lot of commonality between different reconstructi...">Reconstruction</a> </p>

<p class="reference">References <a class="el" href="group__buildblock.html#ga19b3ad285f04d613640a497f868b385f">stir::error()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#acdc605a15c52ab41915aeb36fbf5bea6">input_projdata_sptr</a>, and <a class="el" href="classstir_1_1ScatterEstimation.html#a207441b869453637a816c56ce94952a2">set_input_proj_data_sptr()</a>.</p>

</div>
</div>
<a id="a789d689bc3f266b275d1cd214837ea47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a789d689bc3f266b275d1cd214837ea47">&#9670;&nbsp;</a></span>set_mask_proj_data_sptr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void stir::ScatterEstimation::set_mask_proj_data_sptr </td>
          <td>(</td>
          <td class="paramtype">const shared_ptr&lt; <a class="el" href="classstir_1_1ProjData.html">ProjData</a> &gt;&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set mask for tail-fitting </p>
<p><code>arg</code> will not be modified </p>

</div>
</div>
<a id="a6dfdaa6087a99699346f9ebf77c41d9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dfdaa6087a99699346f9ebf77c41d9a">&#9670;&nbsp;</a></span>get_iterations_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stir::ScatterEstimation::get_iterations_num </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the zoom factor in the XY plane for the downsampling of the activity and attenuation image. </p>
<p>Set the zoom factor in the Z axis for the downsampling of the activity and attenuation image. Get the number of iterations for the scatter estimation</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000025">Deprecated:</a></b></dt><dd>Use <a class="el" href="classstir_1_1ScatterEstimation.html#a48f3eb555800e60b9a2d84a6fdea3dd7" title="Get the number of iterations for the scatter estimation. ">get_num_iterations()</a> </dd></dl>

<p class="reference">References <a class="el" href="group__buildblock.html#ga19b3ad285f04d613640a497f868b385f">stir::error()</a>, <a class="el" href="classstir_1_1FilePath.html#a36aca9b556f0fadcbb2c4c2cc4392a72">stir::FilePath::get_filename()</a>, <a class="el" href="classstir_1_1FilePath.html#a3bd6d8a2d074d66e3172d5a7403f014f">stir::FilePath::get_path()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#acdc605a15c52ab41915aeb36fbf5bea6">input_projdata_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a6215678213614bb082e55776072fe27d">norm_3d_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#acb252446bc6db862fdc6c193d73deec0">num_scatter_iterations</a>, <a class="el" href="classstir_1_1FilePath.html#a5b61dfce42434d1a97dd752271550b74">stir::FilePath::prepend_directory_name()</a>, and <a class="el" href="group__buildblock.html#ga45e27d9de6cdc69c146e791a825a20da">stir::warning()</a>.</p>

</div>
</div>
<a id="aceaf7c9893842d246996d16c0b03f8a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceaf7c9893842d246996d16c0b03f8a0">&#9670;&nbsp;</a></span>post_processing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool stir::ScatterEstimation::post_processing </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This will be called at the end of the parsing. </p>
<dl class="section return"><dt>Returns</dt><dd>false if everything OK, true if not </dd></dl>

<p>Reimplemented from <a class="el" href="classstir_1_1ParsingObject.html#a76911426e945844fe3429191db43af77">stir::ParsingObject</a>.</p>

<p class="reference">References <a class="el" href="classstir_1_1KeyParser.html#a31ac36b0d6259233724f5f1b89ab20fb">stir::KeyParser::add_parsing_key()</a>, <a class="el" href="classstir_1_1KeyParser.html#a2f9888661e50ab3a45504abd91e57d72">stir::KeyParser::add_start_key()</a>, <a class="el" href="classstir_1_1KeyParser.html#aa92a7db6e8ab333adf8741acfcd95cb9">stir::KeyParser::add_stop_key()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a6040476b88557cd0aa6a2cca6cf70b78">atten_coeff_filename</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#aadbf3bda61be8c705662b13084842c35">atten_image_filename</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#ae64ddcfe58e581557a0f795de33e16f3">atten_image_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#aba532c89260e3c4485a34538dfa5598b">back_projdata_filename</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a7362e2fbc1285190f20eaa8630d5fb9e">back_projdata_sptr</a>, <a class="el" href="group__buildblock.html#ga19b3ad285f04d613640a497f868b385f">stir::error()</a>, <a class="el" href="structstir_1_1MaskingParameters.html#a91a2bca35dd177d74727431598631f8b">stir::MaskingParameters::filter_filename</a>, <a class="el" href="structstir_1_1MaskingParameters.html#ad0eb94d02c24188c637acb16f3ff458e">stir::MaskingParameters::filter_sptr</a>, <a class="el" href="group__buildblock.html#ga58339978ae5e7a02db3ba4d82bff5ab6">stir::info()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a5307cc76151c003ff790758bcd8d2055">input_projdata_filename</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#acdc605a15c52ab41915aeb36fbf5bea6">input_projdata_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#acbcc957a4321d7c3840f9485d372aa1a">mask_image_filename</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#ab03f8924b921f10fa4909fe4b350b836">mask_projdata_filename</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a3d823b413eb93823fda273a0d9c72a20">mask_projdata_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a051d5cee13b9001396bedc45b743e0c3">masking_parameters</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a718244af847584c4d7229ebcdac1f233">output_scatter_estimate_prefix</a>, <a class="el" href="classstir_1_1KeyParser.html#a08ca6f6fc94772b3f2832b438a0a6b43">stir::KeyParser::parse()</a>, <a class="el" href="group__IO.html#ga023d6e4a62c18b9df73dd31527f7c648">stir::read_from_file()</a>, <a class="el" href="classstir_1_1ProjData.html#abe098fca9d7ee5dc8a8c14ff6666de97">stir::ProjData::read_from_file()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a2888fb4f785b5b2b7879164d9c035f20">recompute_mask_image</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#ad39840831f0c7a1089c3a19a7899ced8">recompute_mask_projdata</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a1a1773cecc8122d6802aa3f35ad7ce26">recon_template_par_filename</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a22bde20f9710c8acdbf864db610ca6db">reconstruction_template_sptr</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a5bc45dab478fe65fc54695ba8db201f5">set_attenuation_correction_proj_data_sptr()</a>, and <a class="el" href="group__buildblock.html#ga45e27d9de6cdc69c146e791a825a20da">stir::warning()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classstir_1_1ScatterEstimation.html#a7b3b3365671daaf1de03d06c2259017b">ScatterEstimation()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad3ff1d6214ec59be4294a66b6cc106c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3ff1d6214ec59be4294a66b6cc106c8">&#9670;&nbsp;</a></span>tail_mask_par_filename</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string stir::ScatterEstimation::tail_mask_par_filename</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Optional parameter file for the tail fitting. </p>
<p>If not provided, sensible defaults are used </p>

<p class="reference">Referenced by <a class="el" href="classstir_1_1ScatterEstimation.html#af4a883113f5f2ee32f74cbb9a5067d88">initialise_keymap()</a>, and <a class="el" href="classstir_1_1ScatterEstimation.html#a20adf5073f27f5c112203fa1aef4cfc8">process_data()</a>.</p>

</div>
</div>
<a id="a051d5cee13b9001396bedc45b743e0c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a051d5cee13b9001396bedc45b743e0c3">&#9670;&nbsp;</a></span>masking_parameters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structstir_1_1MaskingParameters.html">MaskingParameters</a> stir::ScatterEstimation::masking_parameters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>the set of parameters to obtain a mask from the attenuation image</p>
<p>The attenuation image will be thresholded to find a plausible mask for where there can be emission data. This mask will be then forward projected to find the tails in the projection data.</p>
<p>This is a simple strategy that can fail due to motion etc, so the attenuation image is first blurred, and the default threshold is low.</p>
<p>Note that there is currently no attempt to eliminate the bed from the attenuation image first. Tails are therefore going to be too small, which could create trouble.</p>
<p>By default, a Gaussian filter of FWHM (15,20,20) will be applied before thresholding with a value 0.003 cm^-1 </p>

<p class="reference">Referenced by <a class="el" href="classstir_1_1ScatterEstimation.html#af4a883113f5f2ee32f74cbb9a5067d88">initialise_keymap()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#aceaf7c9893842d246996d16c0b03f8a0">post_processing()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a20adf5073f27f5c112203fa1aef4cfc8">process_data()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a2fed1d09541ce5d92916c08993856318">set_defaults()</a>, and <a class="el" href="classstir_1_1ScatterEstimation.html#a3ba6aebef60bff5fd4cf4850537e68cf">set_up()</a>.</p>

</div>
</div>
<a id="acb252446bc6db862fdc6c193d73deec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb252446bc6db862fdc6c193d73deec0">&#9670;&nbsp;</a></span>num_scatter_iterations</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int stir::ScatterEstimation::num_scatter_iterations</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The number of iterations the scatter estimation will perform. Default = 5. </p>

<p class="reference">Referenced by <a class="el" href="classstir_1_1ScatterEstimation.html#a6dfdaa6087a99699346f9ebf77c41d9a">get_iterations_num()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a48f3eb555800e60b9a2d84a6fdea3dd7">get_num_iterations()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#af4a883113f5f2ee32f74cbb9a5067d88">initialise_keymap()</a>, <a class="el" href="classstir_1_1ScatterEstimation.html#a20adf5073f27f5c112203fa1aef4cfc8">process_data()</a>, and <a class="el" href="classstir_1_1ScatterEstimation.html#a2fed1d09541ce5d92916c08993856318">set_defaults()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/sirfuser/devel/STIRdistrib/STIR/src/include/stir/scatter/<a class="el" href="ScatterEstimation_8h_source.html">ScatterEstimation.h</a></li>
<li>/home/sirfuser/devel/STIRdistrib/STIR/src/include/stir/scatter/ScatterEstimation.inl</li>
<li>/home/sirfuser/devel/STIRdistrib/STIR/src/scatter_buildblock/<a class="el" href="ScatterEstimation_8cxx.html">ScatterEstimation.cxx</a></li>
<li>/home/sirfuser/devel/STIRdistrib/STIR/src/scatter_buildblock/<a class="el" href="upsample__and__fit__scatter__estimate_8cxx.html">upsample_and_fit_scatter_estimate.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 22 2022 20:12:27 for STIR by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
