<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STIR: /home/sirfuser/devel/STIRdistrib/STIR/src/utilities/stir_math.cxx File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STIR
   &#160;<span id="projectnumber">5.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_43e0a1f539e00dcfa1a6bc4d4fee4fc2.html">home</a></li><li class="navelem"><a class="el" href="dir_0b75bdf102f5cf4910d6429d56a66609.html">sirfuser</a></li><li class="navelem"><a class="el" href="dir_bf00ec6aee8436d9dd9bdb27c8ba69c2.html">devel</a></li><li class="navelem"><a class="el" href="dir_f033b80aa1e53a09c27a870e567321ae.html">STIRdistrib</a></li><li class="navelem"><a class="el" href="dir_dee4efe29267f8f1fbd97b7b185bc024.html">STIR</a></li><li class="navelem"><a class="el" href="dir_4d737faa33632d919b5a76c7a560514d.html">src</a></li><li class="navelem"><a class="el" href="dir_64801a3d1b1f0e36b62ae4d60cd8bffe.html">utilities</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stir_math.cxx File Reference<div class="ingroups"><a class="el" href="group__STIR.html">STIR</a> &raquo; <a class="el" href="group__main__programs.html">Executables</a> &raquo; <a class="el" href="group__utilities.html">Utility programs</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>add or multiply data, with some other basic math manipulations  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ArrayFunction_8h_source.html">stir/ArrayFunction.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="DiscretisedDensity_8h_source.html">stir/DiscretisedDensity.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="SegmentByView_8h_source.html">stir/SegmentByView.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="OutputFileFormat_8h_source.html">stir/IO/OutputFileFormat.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="read__from__file_8h_source.html">stir/IO/read_from_file.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Succeeded_8h_source.html">stir/Succeeded.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ProjDataInterfile_8h_source.html">stir/ProjDataInterfile.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ExamInfo_8h_source.html">stir/ExamInfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">stir/utilities.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="NumericInfo_8h_source.html">stir/NumericInfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="KeyParser_8h_source.html">stir/KeyParser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="is__null__ptr_8h_source.html">stir/is_null_ptr.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ParametricDiscretisedDensity_8h_source.html">stir/modelling/ParametricDiscretisedDensity.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="DynamicDiscretisedDensity_8h_source.html">stir/DynamicDiscretisedDensity.h</a>&quot;</code><br />
<code>#include &quot;stir/stir_math.h&quot;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;memory&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9d58f8822cccae0053674efaf241c12a"><td class="memTemplParams" colspan="2"><a id="a9d58f8822cccae0053674efaf241c12a"></a>
template&lt;class DataT , class FunctionObjectT &gt; </td></tr>
<tr class="memitem:a9d58f8822cccae0053674efaf241c12a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>process_data</b> (const string &amp;output_file_name, const int num_files, char **argv, const bool no_math_on_data, const bool except_first, const bool verbose, const bool do_add, const FunctionObjectT &amp;pow_times_add_object, const <a class="el" href="classstir_1_1OutputFileFormat.html">OutputFileFormat</a>&lt; DataT &gt; &amp;output_format)</td></tr>
<tr class="separator:a9d58f8822cccae0053674efaf241c12a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d2f1bc97855499a86de9f4dd14e79b"><td class="memTemplParams" colspan="2"><a id="a63d2f1bc97855499a86de9f4dd14e79b"></a>
template&lt;class FunctionObjectT &gt; </td></tr>
<tr class="memitem:a63d2f1bc97855499a86de9f4dd14e79b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>process_data</b> (const string &amp;output_file_name, const int num_files, char **argv, const bool no_math_on_data, const bool except_first, const bool verbose, const bool do_add, const FunctionObjectT &amp;pow_times_add_object, const <a class="el" href="classstir_1_1OutputFileFormat.html">OutputFileFormat</a>&lt; <a class="el" href="classstir_1_1DynamicDiscretisedDensity.html">DynamicDiscretisedDensity</a> &gt; &amp;output_format)</td></tr>
<tr class="separator:a63d2f1bc97855499a86de9f4dd14e79b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c17b27a5d168196e5e153d9afe3d78"><td class="memTemplParams" colspan="2"><a id="a86c17b27a5d168196e5e153d9afe3d78"></a>
template&lt;class DataT &gt; </td></tr>
<tr class="memitem:a86c17b27a5d168196e5e153d9afe3d78"><td class="memTemplItemLeft" align="right" valign="top">shared_ptr&lt; <a class="el" href="classstir_1_1OutputFileFormat.html">OutputFileFormat</a>&lt; DataT &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>find_output_format</b> (const std::string &amp;filename)</td></tr>
<tr class="separator:a86c17b27a5d168196e5e153d9afe3d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top"><a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>add or multiply data, with some other basic math manipulations </p>
<p>This is a command line utility for adding, multiplying, thresholding ... data, with a somewhat awkward syntax. The command line arguments are as follows (but everything has to fit on 1 line): </p><div class="fragment"><div class="line">[--output-format parameter-filename ]</div><div class="line">[--parametric || --dynamic]</div><div class="line">[-s [--max_segment_num_to_process number] ] </div><div class="line">[--add | --mult] </div><div class="line">[--power power_float] </div><div class="line">[--times-scalar mult_scalar_float] </div><div class="line">[--<a class="code" href="group__numerics.html#ga2135eeda219aa6700b50580389a12771">divide</a>-scalar divide_scalar_float] </div><div class="line">[--add-scalar add_scalar_float] </div><div class="line">[--min-threshold <a class="code" href="namespacedistributed.html#aac893dd256bfd22c5bce0f30000fed83">min_threshold</a>]</div><div class="line">[--max-threshold max_threshold]</div><div class="line">[--including-first] </div><div class="line">[--verbose]</div><div class="line">output_filename_with_extension in_data1 [in_data2 [in_data3...]]</div></div><!-- fragment --><p> or </p><div class="fragment"><div class="line">[--output-format parameter-filename ]</div><div class="line">--accumulate</div><div class="line">[-s] </div><div class="line">[--parametric || --dynamic]</div><div class="line">[--add | --mult] </div><div class="line">[--power power_float] </div><div class="line">[--times-scalar mult_scalar_float] </div><div class="line">[--<a class="code" href="group__numerics.html#ga2135eeda219aa6700b50580389a12771">divide</a>-scalar divide_scalar_float] </div><div class="line">[--add-scalar add_scalar_float] </div><div class="line">[--min-threshold <a class="code" href="namespacedistributed.html#aac893dd256bfd22c5bce0f30000fed83">min_threshold</a>]</div><div class="line">[--max-threshold max_threshold]</div><div class="line">[--including-first] </div><div class="line">[--verbose]</div><div class="line">out_and_input_filename in_data2 [in_data3 [in_data4...]]</div></div><!-- fragment --><p>'&ndash;add' is default, and outputs the sum of the result of processed data. '&ndash;mult' outputs the multiplication of the result of processed data.<br />
 The '&ndash;include-first' option can be used such that power and scalar multiplication are done on the first input argument as well. Otherwise these manipulations are done only on the 2nd, 3rd,.. argument.<br />
 The '&ndash;accumulate' option can be used to say that the first filename given will be used for input AND output. Note that when using this option together with '&ndash;including-first', the data in the first filename will first be manipulated according to '&ndash;power' and '&ndash;times-scalar'.<br />
 The '-s' option is necessary if the arguments are projection data. Otherwise, it is assumed the data are images. '&ndash;parametric' and '&ndash;dynamic' can be used to read parametric/dynamic images.<br />
 For projection data, you can restrict the number of segments read/written using the &ndash;max_segment_num_to_process option (unless &ndash;accumulate is used). For example, using 2 as an argument of this option, will read/write segments -2,-1,0,1,2.<br />
 Multiple occurences of '&ndash;times-scalar' and '&ndash;divide-scalar' are allowed and will just result in accumulation of the factors.</p>
<p>The order of the manipulations is as follows:<br />
 (1) thresholding (2) power (3) scalar multiplication (4) scalar addition.</p>
<p>The '&ndash;output-format' option can be used to write the output in a different file format then the default (although this currently only works for images). The parameter file should have the following format: </p><pre class="fragment">output file format parameters:=
output file format type:= &lt;sometype&gt;
END:=
</pre><p> See the <a class="el" href="classstir_1_1OutputFileFormat.html" title="Base class for classes that create output files. ">stir::OutputFileFormat</a> hierarchy for possible values.</p>
<dl class="section user"><dt>Examples</dt><dd><ul>
<li>
subtracting 2 files<br />
 <div class="fragment"><div class="line">stir_math --times-scalar -1 output in1 in2 </div></div><!-- fragment --> </li>
<li>
sum the square of each file<br />
 <div class="fragment"><div class="line">stir_math --power 2 --including-first output in1 in2 </div></div><!-- fragment --> </li>
<li>
Dividing 2 files after thresholding the 2nd file<br />
 <div class="fragment"><div class="line">stir_math --mult --power -1 --min-threshold .1 output in1 in2 </div></div><!-- fragment --> </li>
<li>
<p class="startli">Dividing 2 files, with first file set to the quotient<br />
 </p><div class="fragment"><div class="line">stir_math --accumulate --mult --power -1 in1 in2 </div></div><!-- fragment --><p class="endli"></p>
</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>There is no check that the data sizes and other info are compatible and the output will have the largest data size in the input, and the characteristics (like voxel-size or so) are taken from the first input data. Hence, lots of funny effects can happen if data are not compatible.</dd>
<dd>
When '&ndash;accumulate' is not used, the output file HAS to be different from all the input files. </dd>
<dd>
The result of using non-integral powers on negative numbers is probably system-dependent. </dd>
<dd>
For future compatibility, it is recommended to put the command line arguments in the order that they will be executed (i.e. as listed above). It might be that we take the order into account in a future release. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Kris Thielemans </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jan 14 2023 14:18:18 for STIR by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
